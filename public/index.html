<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hostel PMS - Sistema de Gesti√≥n para Hostales</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="js/reservations.js"></script>
    <script src="js/analytics.js"></script>
    <script src="js/feedback.js"></script> <!-- Day 8: Feedback Module -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#3498db">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="/icons/icon-192x192.png">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .app {
            display: flex;
            height: 100vh;
        }

        .sidebar {
            width: 260px;
            background: rgba(44, 62, 80, 0.95);
            backdrop-filter: blur(10px);
            color: #2c3e50;
            padding: 20px;
            box-shadow: 4px 0 20px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
            transition: transform 0.3s ease;
        }

        .sidebar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(52, 152, 219, 0.1), rgba(155, 89, 182, 0.1));
            pointer-events: none;
        }

        .logo {
            display: flex;
            align-items: center;
            margin-bottom: 40px;
            position: relative;
            z-index: 1;
        }

        .logo i {
            font-size: 32px;
            color: #3498db;
            margin-right: 12px;
        }

        .logo h2 {
            font-size: 20px;
            font-weight: 700;
            background: linear-gradient(45deg, #3498db, #9b59b6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .nav-button {
            display: flex;
            align-items: center;
            width: 100%;
            padding: 15px 20px;
            margin: 8px 0;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            color: #2c3e50;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-size: 15px;
            text-align: left;
            transition: all 0.3s ease;
            position: relative;
            z-index: 1;
            overflow: hidden;
        }

        .nav-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .nav-button:hover::before {
            left: 100%;
        }

        .nav-button.active {
            background: linear-gradient(135deg, #3498db, #2ecc71);
            box-shadow: 0 8px 20px rgba(52, 152, 219, 0.3);
            transform: translateY(-2px);
        }

        .nav-button:hover {
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.05);
            transform: translateX(5px);
        }

        .nav-button i {
            margin-right: 15px;
            width: 20px;
            text-align: center;
        }

        .logout {
            margin-top: auto;
            background: linear-gradient(135deg, #e74c3c, #c0392b) !important;
        }

        .main-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .dashboard-title {
            color: #2c3e50;
        }

        .dashboard-title h1 {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .dashboard-title p {
            font-size: 16px;
            opacity: 0.8;
        }

        .time-info {
            text-align: right;
            color: #2c3e50;
        }

        .current-time {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .current-date {
            opacity: 0.8;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }

        .stat-card:hover::before {
            opacity: 1;
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .stat-icon {
            font-size: 32px;
            padding: 15px;
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.05);
        }

        .stat-icon.occupied {
            color: #e74c3c;
            background: linear-gradient(135deg, #fdeee8, #f8d7da);
        }

        .stat-icon.clean {
            color: #2ecc71;
            background: rgba(46, 204, 113, 0.2);
        }

        .stat-icon.dirty {
            color: #f39c12;
            background: linear-gradient(135deg, #fef3e2, #fce4b8);
        }

        .stat-icon.revenue {
            color: #3498db;
            background: linear-gradient(135deg, #e8f4fd, #d4e6f1);
        }

        .stat-number {
            font-size: 42px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #2c3e50;
            font-size: 16px;
            margin-bottom: 10px;
        }

        .stat-change {
            display: flex;
            align-items: center;
            font-size: 14px;
            font-weight: 600;
        }

        .stat-change.positive {
            color: #2ecc71;
        }

        .stat-change.negative {
            color: #e74c3c;
        }

        .content-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            height: 250px;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .chart-title {
            color: #2c3e50;
            font-size: 20px;
            font-weight: 600;
        }

        .activity-feed {
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-height: 500px;
            overflow-y: auto;
        }

        .activity-item {
            display: flex;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            animation: slideInRight 0.5s ease;
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 16px;
            color: #2c3e50;
        }

        .activity-icon.checkin {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
        }

        .activity-icon.checkout {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .activity-icon.sale {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }

        .activity-icon.payment {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }

        .activity-content {
            flex: 1;
        }

        .activity-title {
            color: #2c3e50;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .activity-desc {
            color: #7f8c8d;
            font-size: 14px;
        }

        .activity-time {
            color: #bdc3c7;
            font-size: 12px;
        }

        .beds-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }

        .room-section {
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .room-section:last-child {
            height: 300px;
        }

        .room-title {
            color: #2c3e50;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }

        .room-title i {
            margin-right: 10px;
            font-size: 20px;
        }

        .bed-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
        }

        .bed-status {
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 15px;
            color: #2c3e50;
            font-weight: 600;
            text-align: center;
            position: relative;
            overflow: hidden;
            transition: transform 0.3s ease;
            cursor: pointer;
        }

        .bed-status:hover {
            transform: scale(1.05);
        }

        .bed-status.occupied {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            box-shadow: 0 8px 20px rgba(231, 76, 60, 0.3);
        }

        .bed-status.clean {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            box-shadow: 0 8px 20px rgba(46, 204, 113, 0.3);
        }

        .bed-status.dirty {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            box-shadow: 0 8px 20px rgba(243, 156, 18, 0.3);
        }

        .bed-number {
            font-size: 18px;
            margin-bottom: 5px;
        }

        .bed-guest {
            font-size: 11px;
            opacity: 0.9;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.05);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #2ecc71, #3498db);
            border-radius: 4px;
            transition: width 1s ease;
        }

        .financial-overview {
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            margin-bottom: 30px;
        }

        .financial-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .financial-item {
            text-align: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border-radius: 15px;
        }

        .financial-amount {
            font-size: 28px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .financial-label {
            color: #2c3e50;
            font-size: 14px;
        }

        .login-container {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .login-form {
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            width: 400px;
            text-align: center;
        }

        .login-title {
            color: #2c3e50;
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 30px;
            background: linear-gradient(45deg, #3498db, #9b59b6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .login-input {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border: none;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.05);
            color: #2c3e50;
            font-size: 16px;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .login-input::placeholder {
            color: #7f8c8d;
        }

        .login-input:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.3);
            border-color: #3498db;
        }

        .login-button {
            width: 100%;
            padding: 15px;
            margin-top: 20px;
            border: none;
            border-radius: 10px;
            background: linear-gradient(135deg, #3498db, #2ecc71);
            color: #2c3e50;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .login-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(52, 152, 219, 0.3);
        }

        .login-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .error-message {
            color: #ff6b6b;
            background: rgba(255, 107, 107, 0.1);
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            font-size: 14px;
        }

        .hidden {
            display: none;
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(50px);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in-up {
            animation: fadeInUp 0.6s ease forwards;
        }

        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.5);
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .app {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                height: auto;
            }

            .content-grid {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Reports Analytics Styles */
        .date-btn {
            padding: 8px 16px;
            border: 2px solid #3498db;
            border-radius: 25px;
            background: white;
            color: #3498db;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .date-btn:hover {
            background: #3498db;
            color: #2c3e50;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(52, 152, 219, 0.3);
        }

        .date-btn.report-active {
            background: #3498db;
            color: #2c3e50;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(52, 152, 219, 0.3);
        }

        .chart-bar {
            border-radius: 4px 4px 0 0;
            display: flex;
            align-items: end;
            justify-content: center;
            color: #2c3e50;
            font-size: 12px;
            font-weight: bold;
            padding-bottom: 5px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .chart-bar:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .revenue-bar {
            background: linear-gradient(to top, #2980b9, #3498db);
        }

        .occupancy-bar {
            width: 30px;
            border-radius: 2px 2px 0 0;
        }

        .occupancy-high {
            background: linear-gradient(to top, #1e8449, #27ae60);
        }

        .occupancy-medium {
            background: linear-gradient(to top, #d35400, #f39c12);
        }

        .occupancy-low {
            background: linear-gradient(to top, #c0392b, #e74c3c);
        }

        .top-list-item {
            padding: 15px 20px;
            border-bottom: 1px solid #ecf0f1;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.2s ease;
        }

        .top-list-item:hover {
            background: #ecf0f1;
        }

        .top-list-item:last-child {
            border-bottom: none;
        }

        .item-name {
            font-weight: bold;
            color: #2c3e50;
        }

        .item-value {
            font-weight: bold;
            padding: 5px 12px;
            border-radius: 20px;
            color: #2c3e50;
            font-size: 0.9rem;
        }

        .value-nights {
            background: #27ae60;
        }

        .value-sales {
            background: #e67e22;
        }

        /* Light Theme for all tabs */
        .content-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .content-section {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(5px);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .light-text {
            color: #2c3e50;
        }

        .light-text-secondary {
            color: #7f8c8d;
        }

        /* Mobile Responsive Styles */
        .mobile-header {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: rgba(44, 62, 80, 0.95);
            backdrop-filter: blur(10px);
            z-index: 999;
            padding: 0 20px;
            align-items: center;
            justify-content: space-between;
        }

        .mobile-logo {
            color: white;
            font-size: 18px;
            font-weight: 700;
        }

        .hamburger {
            display: none;
            flex-direction: column;
            cursor: pointer;
            padding: 10px;
        }

        .hamburger span {
            width: 25px;
            height: 3px;
            background: white;
            margin: 3px 0;
            transition: 0.3s;
        }

        .hamburger.active span:nth-child(1) {
            transform: rotate(-45deg) translate(-5px, 6px);
        }

        .hamburger.active span:nth-child(2) {
            opacity: 0;
        }

        .hamburger.active span:nth-child(3) {
            transform: rotate(45deg) translate(-5px, -6px);
        }

        @media (max-width: 768px) {
            .mobile-header {
                display: flex;
            }

            .hamburger {
                display: flex;
            }

            .sidebar {
                position: fixed;
                top: 0;
                left: 0;
                height: 100vh;
                z-index: 1000;
                transform: translateX(-100%);
            }

            .sidebar.active {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0 !important;
                padding-top: 100px;
            }

            .app {
                flex-direction: column;
            }

            /* Enhanced Mobile Responsiveness */

            /* Fix header date/time alignment */
            .header {
                flex-direction: column !important;
                text-align: center !important;
                gap: 10px !important;
            }

            /* Stack buttons below content on mobile */
            .action-buttons,
            .button-group {
                flex-direction: column !important;
                align-items: stretch !important;
                gap: 10px !important;
            }

            .action-buttons button,
            .button-group button {
                width: 100% !important;
                margin: 5px 0 !important;
            }

            /* Cards and content responsive */
            .stat-card,
            .content-card {
                margin: 10px 0 !important;
                padding: 15px !important;
            }

            .card-grid {
                grid-template-columns: 1fr !important;
                gap: 15px !important;
            }

            /* Forms responsive */
            .form-row {
                flex-direction: column !important;
                gap: 10px !important;
            }

            .form-row input,
            .form-row select,
            .form-row button {
                width: 100% !important;
                margin: 5px 0 !important;
            }

            /* Tables responsive */
            .data-table {
                font-size: 14px !important;
                overflow-x: auto !important;
            }

            .data-table th,
            .data-table td {
                padding: 8px 4px !important;
                min-width: 80px !important;
            }

            /* Bed grid responsive */
            .bed-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)) !important;
                gap: 10px !important;
            }

            .bed-card {
                min-height: auto !important;
                padding: 10px !important;
            }

            /* Reports responsive */
            .chart-container {
                height: 250px !important;
                margin: 15px 0 !important;
            }

            .kpi-grid {
                grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)) !important;
                gap: 10px !important;
            }

            /* POS responsive */
            .pos-grid {
                grid-template-columns: 1fr !important;
                gap: 15px !important;
            }

            .product-grid {
                grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)) !important;
                gap: 10px !important;
            }

            .cart-item {
                flex-direction: column !important;
                align-items: stretch !important;
                text-align: center !important;
            }

            /* Tours responsive */
            .tours-grid {
                grid-template-columns: 1fr !important;
                gap: 15px !important;
            }

            .tour-card {
                padding: 15px !important;
            }

            /* Staff responsive */
            .staff-grid {
                grid-template-columns: 1fr !important;
                gap: 15px !important;
            }

            /* General text responsive */
            h1 {
                font-size: 1.8rem !important;
            }

            h2 {
                font-size: 1.4rem !important;
            }

            h3 {
                font-size: 1.2rem !important;
            }

            /* Padding adjustments */
            .main-content {
                padding: 100px 15px 15px 15px !important;
            }

            /* Fix date/time display */
            #current-time,
            #current-date {
                font-size: 14px !important;
                text-align: center !important;
                display: block !important;
                margin: 5px 0 !important;
            }
        }
    </style>
</head>

<body>
    <!-- LOGIN SCREEN -->
    <div id="login-screen" class="login-container">
        <div class="login-form">
            <div class="login-title">
                <i class="fas fa-hotel" style="margin-right: 10px;"></i>
                ALMANIK PMS
            </div>
            <div id="login-error" class="error-message hidden"></div>
            <form id="login-form">
                <input type="text" id="username" class="login-input" placeholder="Usuario" value="admin" required>
                <input type="password" id="password" class="login-input" placeholder="Contrase√±a" value="admin123"
                    required>
                <button type="submit" id="login-btn" class="login-button">
                    INGRESAR AL SISTEMA
                </button>
            </form>
            <div style="margin-top: 20px; color: #7f8c8d; font-size: 12px;">
                <p>Demo: admin / admin123</p>
                <p>Sistema de gesti√≥n para hostales</p>
            </div>
        </div>
    </div>

    <!-- MAIN APPLICATION -->
    <div id="main-app" class="app hidden">
        <!-- MOBILE HEADER -->
        <div class="mobile-header">
            <div class="mobile-logo">
                <i class="fas fa-hotel"></i> HOSTEL PMS
            </div>
            <div class="hamburger" onclick="toggleSidebar()">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>

        <!-- SIDEBAR -->
        <div class="sidebar">
            <div class="logo">
                <i class="fas fa-hotel"></i>
                <h2>HOSTEL PMS</h2>
            </div>

            <button class="nav-button active" onclick="showView('dashboard')">
                <i class="fas fa-chart-pie"></i>Tablero
            </button>

            <button class="nav-button" onclick="showView('beds')">
                <i class="fas fa-bed"></i>Camas
            </button>

            <button class="nav-button" onclick="showView('guests')">
                <i class="fas fa-users"></i>Hu√©spedes
            </button>

            <button class="nav-button" onclick="showView('pos')">
                <i class="fas fa-cash-register"></i>Ventas
            </button>

            <button class="nav-button" onclick="showView('staff')">
                <i class="fas fa-user-tie"></i>Personal
            </button>

            <button class="nav-button" onclick="showView('cash')">
                <i class="fas fa-coins"></i>Caja
            </button>

            <div class="nav-item" onclick="showSection('analytics')">
                <i class="fas fa-chart-line"></i> Analytics
            </div>
            <a href="/reports-advanced.html" class="nav-item" style="text-decoration: none; color: inherit;">
                <i class="fas fa-brain"></i> AI Reports
            </a>
            <div class="nav-item" onclick="showSection('settings')">
                <i class="fas fa-map-marked-alt"></i>Paseos
            </div>

            <button class="nav-button" onclick="showView('reports')">
                <i class="fas fa-chart-bar"></i>Reportes
            </button>

            <button class="nav-button" onclick="showView('tours')">
                <i class="fas fa-map-marked-alt"></i>Paseos
            </button>

            <button class="nav-button" onclick="showView('users')" id="users-nav" style="display: none;">
                <i class="fas fa-user-cog"></i>Usuarios
            </button>

            <button class="nav-button logout" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i>Salir
            </button>
        </div>

        <!-- MAIN CONTENT -->
        <div class="main-content">
            <!-- DASHBOARD VIEW -->
            <div id="dashboard-view" class="fade-in-up">
                <!-- HEADER -->
                <div class="dashboard-header">
                    <div class="dashboard-title">
                        <h1>¬°Bienvenido, Administrador!</h1>
                        <p>Aqu√≠ est√° lo que est√° pasando en tu hostal hoy</p>
                    </div>
                    <div class="time-info">
                        <div class="current-time" id="current-time">10:42 AM</div>
                        <div class="current-date" id="current-date">Mi√©rcoles, 2 Oct, 2024</div>
                    </div>
                </div>

                <!-- STATS GRID -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-header">
                            <div>
                                <div class="stat-number" id="occupied-count">12</div>
                                <div class="stat-label">Camas Ocupadas</div>
                                <div class="stat-change positive">
                                    <i class="fas fa-arrow-up"></i> +2 desde ayer
                                </div>
                            </div>
                            <div class="stat-icon occupied">
                                <i class="fas fa-bed"></i>
                            </div>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="occupied-progress" style="width: 75%"></div>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div>
                                <div class="stat-number" id="clean-count">8</div>
                                <div class="stat-label">Camas Disponibles</div>
                                <div class="stat-change positive">
                                    <i class="fas fa-check"></i> Listas para hu√©spedes
                                </div>
                            </div>
                            <div class="stat-icon clean">
                                <i class="fas fa-check-circle"></i>
                            </div>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="clean-progress" style="width: 40%"></div>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div>
                                <div class="stat-number" id="dirty-count">3</div>
                                <div class="stat-label">Camas por Limpiar</div>
                                <div class="stat-change negative">
                                    <i class="fas fa-exclamation"></i> Necesitan limpieza
                                </div>
                            </div>
                            <div class="stat-icon dirty">
                                <i class="fas fa-exclamation-triangle"></i>
                            </div>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="dirty-progress" style="width: 15%"></div>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div>
                                <div class="stat-number" id="revenue-amount">$122.000</div>
                                <div class="stat-label">Ingresos de Hoy</div>
                                <div class="stat-change positive">
                                    <i class="fas fa-arrow-up"></i> +15% vs ayer
                                </div>
                            </div>
                            <div class="stat-icon revenue">
                                <i class="fas fa-dollar-sign"></i>
                            </div>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 85%"></div>
                        </div>
                    </div>
                </div>

                <!-- FINANCIAL OVERVIEW -->
                <div class="financial-overview">
                    <h3 class="chart-title" style="margin-bottom: 20px;">
                        <i class="fas fa-chart-line" style="margin-right: 10px;"></i>
                        Resumen Financiero
                    </h3>
                    <div class="financial-grid">
                        <div class="financial-item">
                            <div class="financial-amount">$2.450.000</div>
                            <div class="financial-label">Ingresos Semanales</div>
                        </div>
                        <div class="financial-item">
                            <div class="financial-amount" style="color: #e74c3c;">$1.230.000</div>
                            <div class="financial-label">Gastos Semanales</div>
                        </div>
                        <div class="financial-item">
                            <div class="financial-amount" style="color: #f39c12;">$1.220.000</div>
                            <div class="financial-label">Ganancia Neta</div>
                        </div>
                        <div class="financial-item">
                            <div class="financial-amount" style="color: #9b59b6;" id="occupancy-rate">89%</div>
                            <div class="financial-label">Tasa de Ocupaci√≥n</div>
                        </div>
                    </div>
                </div>

                <!-- MAIN CONTENT GRID -->
                <div class="content-grid">
                    <!-- OCCUPANCY CHART -->
                    <div class="chart-container">
                        <div class="chart-header">
                            <h3 class="chart-title">
                                <i class="fas fa-chart-area" style="margin-right: 10px;"></i>
                                Tendencias de Ocupaci√≥n (7 d√≠as)
                            </h3>
                        </div>
                        <canvas id="occupancyChart" width="400" height="150"></canvas>
                    </div>

                    <!-- ACTIVITY FEED -->
                    <div class="activity-feed">
                        <h3 class="chart-title" style="margin-bottom: 20px;">
                            <i class="fas fa-clock" style="margin-right: 10px;"></i>
                            Actividad Reciente
                        </h3>

                        <div id="activity-list">
                            <!-- Activities will be loaded here -->
                        </div>
                    </div>
                </div>

                <!-- BEDS OVERVIEW -->
                <div class="beds-overview">
                    <!-- DORM ROOMS -->
                    <div class="room-section">
                        <div class="room-title">
                            <i class="fas fa-door-open"></i>
                            Habitaciones Compartidas
                        </div>
                        <div class="bed-grid" id="dorm-beds">
                            <!-- Beds will be loaded here -->
                        </div>
                    </div>

                    <!-- PRIVATE ROOMS -->
                    <div class="room-section">
                        <div class="room-title">
                            <i class="fas fa-key"></i>
                            Habitaciones Privadas
                        </div>
                        <div class="bed-grid" id="private-beds">
                            <!-- Beds will be loaded here -->
                        </div>
                    </div>

                    <!-- REVENUE BREAKDOWN -->
                    <div class="room-section">
                        <div class="room-title">
                            <i class="fas fa-chart-pie"></i>
                            Desglose de Ingresos
                        </div>
                        <canvas id="revenueChart" width="250" height="200"></canvas>
                    </div>
                </div>
            </div>

            <!-- Other views (placeholder) -->
            <div id="beds-view" class="hidden">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                    <h1 style="color: #2c3e50; margin: 0;">üõèÔ∏è Gesti√≥n de Camas</h1>
                    <div style="display: flex; gap: 10px;">
                        <button onclick="showAddBedModal()"
                            style="padding: 10px 20px; background: #27ae60; color: white; border: none; border-radius: 5px; cursor: pointer;">
                            <i class="fas fa-plus"></i> Nueva Cama
                        </button>
                        <button onclick="refreshBeds()"
                            style="padding: 10px 20px; background: #3498db; color: white; border: none; border-radius: 5px; cursor: pointer;">
                            <i class="fas fa-sync"></i> Actualizar
                        </button>
                    </div>
                </div>

                <!-- Resumen de estado -->
                <div
                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 30px;">
                    <div
                        style="background: linear-gradient(135deg, #e8f5e8, #d4ecd4); padding: 15px; border-radius: 8px; text-align: center; border: 2px solid #27ae60;">
                        <div style="color: #2c3e50; font-size: 24px; font-weight: bold;" id="clean-beds-count">0</div>
                        <div style="color: #2c3e50; font-size: 14px; font-weight: 600;">Disponibles</div>
                    </div>
                    <div
                        style="background: linear-gradient(135deg, #fdeee8, #f8d7da); padding: 15px; border-radius: 8px; text-align: center; border: 2px solid #e74c3c;">
                        <div style="color: #2c3e50; font-size: 24px; font-weight: bold;" id="occupied-beds-count">0
                        </div>
                        <div style="color: #2c3e50; font-size: 14px; font-weight: 600;">Ocupadas</div>
                    </div>
                    <div
                        style="background: linear-gradient(135deg, #fef3e2, #fce4b8); padding: 15px; border-radius: 8px; text-align: center; border: 2px solid #f39c12;">
                        <div style="color: #2c3e50; font-size: 24px; font-weight: bold;" id="dirty-beds-count">0</div>
                        <div style="color: #2c3e50; font-size: 14px; font-weight: 600;">Por Limpiar</div>
                    </div>
                    <div
                        style="background: linear-gradient(135deg, #e8f4fd, #d4e6f1); padding: 15px; border-radius: 8px; text-align: center; border: 2px solid #3498db;">
                        <div style="color: #2c3e50; font-size: 24px; font-weight: bold;" id="total-beds-count">0</div>
                        <div style="color: #2c3e50; font-size: 14px; font-weight: 600;">Total</div>
                    </div>
                </div>

                <!-- Habitaciones organizadas -->
                <div id="rooms-container">
                    <!-- Las habitaciones se cargar√°n aqu√≠ din√°micamente -->
                </div>
            </div>
            <div id="guests-view" class="hidden">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                    <h1 style="color: #2c3e50; margin: 0;">üë• Gesti√≥n de Hu√©spedes</h1>
                    <div style="display: flex; gap: 10px;">
                        <button onclick="showAddGuestModal()"
                            style="padding: 10px 20px; background: #27ae60; color: white; border: none; border-radius: 5px; cursor: pointer;">
                            <i class="fas fa-plus"></i> Nuevo Hu√©sped
                        </button>
                        <button onclick="refreshGuests()"
                            style="padding: 10px 20px; background: #3498db; color: white; border: none; border-radius: 5px; cursor: pointer;">
                            <i class="fas fa-sync"></i> Actualizar
                        </button>
                    </div>
                </div>

                <!-- Estad√≠sticas de hu√©spedes -->
                <div
                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin-bottom: 30px;">
                    <div
                        style="background: linear-gradient(135deg, #e8f4fd, #d4e6f1); padding: 15px; border-radius: 8px; text-align: center; border: 2px solid #3498db;">
                        <div style="color: #2c3e50; font-size: 24px; font-weight: bold;" id="total-guests-count">0</div>
                        <div style="color: #2c3e50; font-size: 14px; font-weight: 600;">Total Hu√©spedes</div>
                    </div>
                    <div
                        style="background: linear-gradient(135deg, #e8f5e8, #d4ecd4); padding: 15px; border-radius: 8px; text-align: center; border: 2px solid #27ae60;">
                        <div style="color: #2c3e50; font-size: 24px; font-weight: bold;" id="staying-guests-count">0
                        </div>
                        <div style="color: #2c3e50; font-size: 14px; font-weight: 600;">Hospedados Ahora</div>
                    </div>
                    <div
                        style="background: rgba(155, 89, 182, 0.2); padding: 15px; border-radius: 8px; text-align: center; border: 2px solid #9b59b6;">
                        <div style="color: #2c3e50; font-size: 24px; font-weight: bold;" id="active-bookings-count">0
                        </div>
                        <div style="color: #2c3e50; font-size: 14px; font-weight: 600;">Reservas Activas</div>
                    </div>
                </div>

                <!-- B√∫squeda avanzada -->
                <div
                    style="background: rgba(255,255,255,0.95); box-shadow: 0 8px 32px rgba(0,0,0,0.1); border-radius: 10px; padding: 20px; margin-bottom: 20px;">
                    <h3 style="color: #2c3e50; margin: 0 0 15px 0;">üîç B√∫squeda de Hu√©spedes</h3>
                    <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
                        <input type="text" id="guest-search"
                            placeholder="Buscar por nombre, documento, email o tel√©fono..."
                            style="flex: 1; min-width: 300px; padding: 12px; border: none; border-radius: 8px; background: rgba(255,255,255,0.9);"
                            onkeypress="if(event.key==='Enter') searchGuests()">
                        <button onclick="searchGuests()"
                            style="padding: 12px 20px; background: linear-gradient(135deg, #3498db, #2980b9); color: #2c3e50; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                            <i class="fas fa-search"></i> Buscar
                        </button>
                        <button onclick="clearSearchAndLoadAll()"
                            style="padding: 12px 20px; background: linear-gradient(135deg, #95a5a6, #7f8c8d); color: #2c3e50; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                            <i class="fas fa-times"></i> Limpiar
                        </button>
                    </div>
                </div>

                <!-- Lista de Hu√©spedes -->
                <div id="guests-container">
                    <!-- Lista de hu√©spedes se carga aqu√≠ -->
                </div>
            </div>
            <div id="pos-view" class="hidden">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                    <h1 style="color: #2c3e50; margin: 0;">üõí Sistema de Ventas (POS)</h1>
                    <div style="color: #2c3e50; font-size: 18px;">
                        Total: $<span id="cart-total">0.00</span>
                    </div>
                </div>

                <div class="pos-grid" style="display: grid; grid-template-columns: 2fr 1fr; gap: 20px;">
                    <!-- Productos -->
                    <div>
                        <h2 style="color: #2c3e50; margin-bottom: 15px;">üì¶ Productos Disponibles</h2>
                        <div id="products-grid" class="product-grid"
                            style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px;">
                            <!-- Productos se cargan aqu√≠ -->
                        </div>
                    </div>

                    <!-- Carrito -->
                    <div
                        style="background: rgba(255,255,255,0.95); box-shadow: 0 8px 32px rgba(0,0,0,0.1); border-radius: 10px; padding: 20px;">
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <h2 style="color: #2c3e50; margin: 0;">üõçÔ∏è Carrito de Compras</h2>
                            <button onclick="clearCart()"
                                style="padding: 8px 12px; background: #e74c3c; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 12px;">
                                üóëÔ∏è Limpiar
                            </button>
                        </div>

                        <div id="cart-items" style="margin-bottom: 20px; max-height: 300px; overflow-y: auto;">
                            <!-- Items del carrito -->
                        </div>

                        <div style="border-top: 1px solid rgba(255,255,255,0.3); padding-top: 15px;">
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                <span style="color: #2c3e50; font-size: 18px; font-weight: bold;">Total:</span>
                                <span style="color: #27ae60; font-size: 24px; font-weight: bold;">$<span
                                        id="cart-total">0</span></span>
                            </div>

                            <select id="payment-method"
                                style="width: 100%; padding: 12px; margin-bottom: 15px; border: none; border-radius: 8px; background: white; color: #2c3e50; font-size: 14px;">
                                <option value="cash">üíµ Efectivo</option>
                                <option value="card">üí≥ Tarjeta</option>
                                <option value="room">üõèÔ∏è Cargar a Habitaci√≥n</option>
                            </select>

                            <button onclick="processSale()"
                                style="width: 100%; padding: 15px; background: linear-gradient(135deg, #27ae60, #2ecc71); color: #2c3e50; border: none; border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: bold; transition: all 0.3s ease;">
                                <i class="fas fa-cash-register"></i> Procesar Venta
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <div id="staff-view" class="hidden">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                    <h1 style="color: #2c3e50; margin: 0;">üë®‚Äçüíº Gesti√≥n de Personal</h1>
                    <button onclick="showAddStaffModal()"
                        style="padding: 10px 20px; background: #9b59b6; color: #2c3e50; border: none; border-radius: 5px; cursor: pointer;">
                        <i class="fas fa-plus"></i> Nuevo Empleado
                    </button>
                </div>

                <!-- Resumen de turnos del d√≠a -->
                <div
                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
                    <div
                        style="background: rgba(255,255,255,0.95); box-shadow: 0 8px 32px rgba(0,0,0,0.1); padding: 20px; border-radius: 10px;">
                        <h3 style="color: #2c3e50; margin-bottom: 10px;">‚è∞ Turno Actual</h3>
                        <p style="color: #2c3e50; margin: 5px 0;">Recepci√≥n: Juan P√©rez</p>
                        <p style="color: #2c3e50; margin: 5px 0;">Limpieza: Mar√≠a Garc√≠a</p>
                        <p style="color: #2c3e50; margin: 5px 0;">Seguridad: Carlos L√≥pez</p>
                    </div>

                    <div
                        style="background: rgba(255,255,255,0.95); box-shadow: 0 8px 32px rgba(0,0,0,0.1); padding: 20px; border-radius: 10px;">
                        <h3 style="color: #2c3e50; margin-bottom: 10px;">‚è±Ô∏è Pr√≥ximo Turno</h3>
                        <p style="color: #2c3e50; margin: 5px 0;">Recepci√≥n: Ana Ruiz (18:00)</p>
                        <p style="color: #2c3e50; margin: 5px 0;">Limpieza: Pedro Silva (06:00)</p>
                        <p style="color: #2c3e50; margin: 5px 0;">Seguridad: Luis Torres (22:00)</p>
                    </div>
                </div>

                <!-- Lista de empleados -->
                <div
                    style="background: rgba(255,255,255,0.95); box-shadow: 0 8px 32px rgba(0,0,0,0.1); border-radius: 10px; padding: 20px;">
                    <h2 style="color: #2c3e50; margin-bottom: 15px;">üìã Lista de Empleados</h2>
                    <div id="staff-list">
                        <!-- Lista de staff se carga aqu√≠ -->
                    </div>
                </div>
            </div>
            <div id="cash-view" class="hidden">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                    <h1 style="color: #2c3e50; margin: 0;">üí∞ Gesti√≥n de Caja</h1>
                    <button onclick="showCashMovementModal()"
                        style="padding: 10px 20px; background: #f39c12; color: white; border: none; border-radius: 5px; cursor: pointer;">
                        <i class="fas fa-plus"></i> Nuevo Movimiento
                    </button>
                </div>

                <!-- Resumen de caja -->
                <div
                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
                    <div
                        style="background: linear-gradient(135deg, #e8f5e8, #d4ecd4); padding: 20px; border-radius: 10px; border: 2px solid #27ae60;">
                        <h3 style="color: #2c3e50; margin-bottom: 10px;">üíµ Efectivo en Caja</h3>
                        <div style="color: #2c3e50; font-size: 24px; font-weight: bold;">$1,245.50</div>
                    </div>

                    <div
                        style="background: linear-gradient(135deg, #e8f4fd, #d4e6f1); padding: 20px; border-radius: 10px; border: 2px solid #3498db;">
                        <h3 style="color: #2c3e50; margin-bottom: 10px;">üí≥ Pagos con Tarjeta</h3>
                        <div style="color: #2c3e50; font-size: 24px; font-weight: bold;">$890.00</div>
                    </div>

                    <div
                        style="background: rgba(155, 89, 182, 0.2); padding: 20px; border-radius: 10px; border: 2px solid #9b59b6;">
                        <h3 style="color: #2c3e50; margin-bottom: 10px;">üìä Total del D√≠a</h3>
                        <div style="color: #2c3e50; font-size: 24px; font-weight: bold;">$2,135.50</div>
                    </div>
                </div>

                <!-- Movimientos recientes -->
                <div
                    style="background: rgba(255,255,255,0.95); box-shadow: 0 8px 32px rgba(0,0,0,0.1); border-radius: 10px; padding: 20px;">
                    <h2 style="color: #2c3e50; margin-bottom: 15px;">üìã Movimientos del D√≠a</h2>
                    <div id="cash-movements-list">
                        <!-- Movimientos se cargan aqu√≠ -->
                    </div>
                </div>
            </div>

            <div id="reports-view" class="hidden">
                <!-- HEADER -->
                <div style="text-align: center; color: #2c3e50; margin-bottom: 30px;">
                    <h1 style="font-size: 2.5rem; margin-bottom: 10px; text-shadow: 0 2px 4px rgba(0,0,0,0.3);">üìà
                        Reports & Analytics</h1>
                    <p>Sistema completo de an√°lisis para Hostel PMS</p>
                </div>

                <!-- FILTROS Y CONFIGURACI√ìN -->
                <div
                    style="background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border-radius: 15px; padding: 25px; margin-bottom: 25px; box-shadow: 0 8px 32px rgba(0,0,0,0.1); border: 1px solid rgba(255, 255, 255, 0.2);">
                    <h3 style="color: #2c3e50; margin-bottom: 20px;">üîß Configuraci√≥n de Reportes</h3>

                    <div style="margin-bottom: 20px;">
                        <label style="font-weight: bold; color: #2c3e50; margin-bottom: 8px; display: block;">Per√≠odo de
                            An√°lisis:</label>
                        <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 15px;">
                            <button class="date-btn" onclick="selectReportPeriod(this, 7)">7 d√≠as</button>
                            <button class="date-btn report-active" onclick="selectReportPeriod(this, 30)">30
                                d√≠as</button>
                            <button class="date-btn" onclick="selectReportPeriod(this, 90)">3 meses</button>
                            <button class="date-btn" onclick="selectReportPeriod(this, 180)">6 meses</button>
                            <button class="date-btn" onclick="selectReportPeriod(this, 365)">1 a√±o</button>
                        </div>
                    </div>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                        <div>
                            <label style="font-weight: bold; color: #2c3e50; margin-bottom: 8px; display: block;">Fecha
                                Inicio:</label>
                            <input type="date" id="reportStartDate"
                                style="padding: 12px; border: 2px solid #ecf0f1; border-radius: 8px; font-size: 14px; width: 100%;">
                        </div>
                        <div>
                            <label style="font-weight: bold; color: #2c3e50; margin-bottom: 8px; display: block;">Fecha
                                Fin:</label>
                            <input type="date" id="reportEndDate"
                                style="padding: 12px; border: 2px solid #ecf0f1; border-radius: 8px; font-size: 14px; width: 100%;">
                        </div>
                        <div>
                            <label style="font-weight: bold; color: #2c3e50; margin-bottom: 8px; display: block;">Tipo
                                de Reporte:</label>
                            <select id="reportType"
                                style="padding: 12px; border: 2px solid #ecf0f1; border-radius: 8px; font-size: 14px; width: 100%;">
                                <option value="overview" selected>üìä Resumen General</option>
                                <option value="revenue">üí∞ An√°lisis Financiero</option>
                                <option value="occupancy">üõèÔ∏è An√°lisis de Ocupaci√≥n</option>
                                <option value="guests">üë• An√°lisis de Hu√©spedes</option>
                                <option value="pos">üõí An√°lisis de Ventas POS</option>
                            </select>
                        </div>
                    </div>

                    <div style="display: flex; gap: 15px; flex-wrap: wrap; margin-top: 20px;">
                        <button onclick="generateAnalyticsReport()"
                            style="padding: 12px 24px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 14px; background: linear-gradient(135deg, #27ae60, #2ecc71); color: #2c3e50;">
                            üîç Generar Reporte
                        </button>
                        <button onclick="exportAnalyticsReport()"
                            style="padding: 12px 24px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 14px; background: linear-gradient(135deg, #9b59b6, #8e44ad); color: #2c3e50;">
                            üì• Exportar Datos
                        </button>
                        <button onclick="refreshReports()"
                            style="padding: 12px 24px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 14px; background: linear-gradient(135deg, #3498db, #2980b9); color: #2c3e50;">
                            <i class="fas fa-sync"></i> Actualizar
                        </button>
                    </div>
                </div>

                <!-- CONTENIDO DEL REPORTE -->
                <div id="reportContent">
                    <!-- KPIs PRINCIPALES -->
                    <div
                        style="background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border-radius: 15px; padding: 25px; margin-bottom: 25px; box-shadow: 0 8px 32px rgba(0,0,0,0.1); border: 1px solid rgba(255, 255, 255, 0.2);">
                        <div style="text-align: center; margin-bottom: 30px;">
                            <h3 style="color: #2c3e50;">üìä KPIs Principales</h3>
                            <div id="reportPeriodBadge"
                                style="display: inline-block; background: linear-gradient(135deg, #667eea, #764ba2); color: #2c3e50; padding: 8px 20px; border-radius: 25px; font-weight: bold; font-size: 0.9rem; margin-top: 10px;">
                                √öltimos 30 d√≠as
                            </div>
                        </div>

                        <div
                            style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
                            <div id="kpiRevenue"
                                style="padding: 25px; border-radius: 12px; text-align: center; background: linear-gradient(135deg, #e8f5e8, #d4ecd4); border: 2px solid #27ae60; color: #27ae60;">
                                <div style="font-size: 2.5rem; font-weight: bold; margin-bottom: 8px;">$0</div>
                                <div style="font-size: 1rem; font-weight: bold; margin-bottom: 5px;">Ingresos Totales
                                </div>
                                <div style="font-size: 0.9rem; opacity: 0.8;">Promedio diario: $0</div>
                            </div>

                            <div id="kpiOccupancy"
                                style="padding: 25px; border-radius: 12px; text-align: center; background: linear-gradient(135deg, #e8f4fd, #d4e6f1); border: 2px solid #3498db; color: #3498db;">
                                <div style="font-size: 2.5rem; font-weight: bold; margin-bottom: 8px;">0%</div>
                                <div style="font-size: 1rem; font-weight: bold; margin-bottom: 5px;">Ocupaci√≥n Promedio
                                </div>
                                <div style="font-size: 0.9rem; opacity: 0.8;">0 noches vendidas</div>
                            </div>

                            <div id="kpiGuests"
                                style="padding: 25px; border-radius: 12px; text-align: center; background: linear-gradient(135deg, #fef3e2, #fce4b8); border: 2px solid #f39c12; color: #f39c12;">
                                <div style="font-size: 2.5rem; font-weight: bold; margin-bottom: 8px;">0</div>
                                <div style="font-size: 1rem; font-weight: bold; margin-bottom: 5px;">Hu√©spedes √önicos
                                </div>
                                <div style="font-size: 0.9rem; opacity: 0.8;">0 hu√©spedes recurrentes</div>
                            </div>

                            <div id="kpiRate"
                                style="padding: 25px; border-radius: 12px; text-align: center; background: linear-gradient(135deg, #fdf2f8, #f5e6ed); border: 2px solid #e91e63; color: #e91e63;">
                                <div style="font-size: 2.5rem; font-weight: bold; margin-bottom: 8px;">$0</div>
                                <div style="font-size: 1rem; font-weight: bold; margin-bottom: 5px;">Tarifa Promedio
                                </div>
                                <div style="font-size: 0.9rem; opacity: 0.8;">ADR (Average Daily Rate)</div>
                            </div>
                        </div>
                    </div>

                    <!-- TENDENCIAS Y GR√ÅFICOS -->
                    <div
                        style="background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border-radius: 15px; padding: 25px; margin-bottom: 25px; box-shadow: 0 8px 32px rgba(0,0,0,0.1); border: 1px solid rgba(255, 255, 255, 0.2);">
                        <h3 style="color: #2c3e50; margin-bottom: 25px;">üìà Tendencias del Per√≠odo</h3>

                        <div
                            style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 25px; margin-bottom: 30px;">
                            <div
                                style="background: #f8f9fa; padding: 20px; border-radius: 12px; border: 1px solid #dee2e6;">
                                <h4 style="color: #2c3e50; margin-bottom: 15px;">üí∞ Ingresos por Semana</h4>
                                <div id="revenueChart"
                                    style="height: 200px; display: flex; align-items: end; gap: 10px; margin-bottom: 10px;">
                                    <!-- Chart bars will be generated here -->
                                </div>
                                <div style="color: #7f8c8d; font-size: 12px; text-align: center;">
                                    √öltimas 5 semanas
                                </div>
                            </div>

                            <div
                                style="background: #f8f9fa; padding: 20px; border-radius: 12px; border: 1px solid #dee2e6;">
                                <h4 style="color: #2c3e50; margin-bottom: 15px;">üõèÔ∏è Ocupaci√≥n Diaria (√∫ltima semana)
                                </h4>
                                <div id="occupancyChart"
                                    style="height: 200px; display: flex; align-items: end; gap: 10px; margin-bottom: 10px;">
                                    <!-- Chart bars will be generated here -->
                                </div>
                                <div style="color: #7f8c8d; font-size: 12px; text-align: center;">
                                    Verde: >80% | Amarillo: 60-80% | Rojo: <60% </div>
                                </div>
                            </div>
                        </div>

                        <!-- TOP PERFORMERS -->
                        <div
                            style="background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border-radius: 15px; padding: 25px; margin-bottom: 25px; box-shadow: 0 8px 32px rgba(0,0,0,0.1); border: 1px solid rgba(255, 255, 255, 0.2);">
                            <h3 style="color: #2c3e50; margin-bottom: 25px;">üèÜ Top Performers</h3>

                            <div
                                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px;">
                                <div
                                    style="background: #f8f9fa; border-radius: 12px; overflow: hidden; border: 1px solid #dee2e6;">
                                    <div
                                        style="background: linear-gradient(135deg, #2c3e50, #34495e); color: #2c3e50; padding: 20px; font-weight: bold;">
                                        üë• Top Hu√©spedes (por noches)
                                    </div>
                                    <div id="topGuests">
                                        <!-- Top guests will be loaded here -->
                                    </div>
                                </div>

                                <div
                                    style="background: #f8f9fa; border-radius: 12px; overflow: hidden; border: 1px solid #dee2e6;">
                                    <div
                                        style="background: linear-gradient(135deg, #2c3e50, #34495e); color: #2c3e50; padding: 20px; font-weight: bold;">
                                        üõí Productos M√°s Vendidos
                                    </div>
                                    <div id="topProducts">
                                        <!-- Top products will be loaded here -->
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- AN√ÅLISIS ADICIONAL -->
                        <div
                            style="background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border-radius: 15px; padding: 25px; margin-bottom: 25px; box-shadow: 0 8px 32px rgba(0,0,0,0.1); border: 1px solid rgba(255, 255, 255, 0.2);">
                            <h3 style="color: #2c3e50; margin-bottom: 20px;">üìä An√°lisis Adicional</h3>

                            <div
                                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                                <div id="weekendOccupancy"
                                    style="padding: 20px; background: #e8f5e8; border-radius: 10px; border: 2px solid #27ae60;">
                                    <div style="color: #27ae60; font-size: 1.5rem; font-weight: bold;">0%</div>
                                    <div style="color: #2c3e50; font-weight: bold;">Tasa de Ocupaci√≥n de Fines de Semana
                                    </div>
                                    <div style="color: #7f8c8d; font-size: 0.9rem;">Rendimiento de fines de semana</div>
                                </div>

                                <div id="avgStay"
                                    style="padding: 20px; background: #fef3e2; border-radius: 10px; border: 2px solid #f39c12;">
                                    <div style="color: #f39c12; font-size: 1.5rem; font-weight: bold;">0 d√≠as</div>
                                    <div style="color: #2c3e50; font-weight: bold;">Estancia Promedio</div>
                                    <div style="color: #7f8c8d; font-size: 0.9rem;">Duraci√≥n media de hospedaje</div>
                                </div>

                                <div id="returningGuests"
                                    style="padding: 20px; background: #e8f4fd; border-radius: 10px; border: 2px solid #3498db;">
                                    <div style="color: #3498db; font-size: 1.5rem; font-weight: bold;">0%</div>
                                    <div style="color: #2c3e50; font-weight: bold;">Tasa de Hu√©spedes Recurrentes</div>
                                    <div style="color: #7f8c8d; font-size: 0.9rem;">Nivel de fidelizaci√≥n</div>
                                </div>

                                <div id="posRevenue"
                                    style="padding: 20px; background: #fdf2f8; border-radius: 10px; border: 2px solid #e91e63;">
                                    <div style="color: #e91e63; font-size: 1.5rem; font-weight: bold;">$0</div>
                                    <div style="color: #2c3e50; font-weight: bold;">Ingresos POS</div>
                                    <div style="color: #7f8c8d; font-size: 0.9rem;">0% del total</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="tours-view" class="hidden">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                        <h1 style="color: #2c3e50; margin: 0;">üö∂ Gesti√≥n de Paseos</h1>
                        <button onclick="showAddTourModal()"
                            style="padding: 10px 20px; background: #9b59b6; color: #2c3e50; border: none; border-radius: 5px; cursor: pointer;">
                            <i class="fas fa-plus"></i> Nuevo Paseo
                        </button>
                    </div>

                    <!-- Estad√≠sticas de comisiones -->
                    <div
                        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 30px;">
                        <div
                            style="background: linear-gradient(135deg, #e8f5e8, #d4ecd4); padding: 15px; border-radius: 8px; text-align: center; border: 2px solid #27ae60;">
                            <div style="color: #2c3e50; font-size: 24px; font-weight: bold;" id="total-tours-count">0
                            </div>
                            <div style="color: #2c3e50; font-size: 14px; font-weight: 600;">Tours Disponibles</div>
                        </div>
                        <div
                            style="background: linear-gradient(135deg, #e8f4fd, #d4e6f1); padding: 15px; border-radius: 8px; text-align: center; border: 2px solid #3498db;">
                            <div style="color: #2c3e50; font-size: 24px; font-weight: bold;" id="total-clicks-count">0
                            </div>
                            <div style="color: #2c3e50; font-size: 14px; font-weight: 600;">Clicks Totales</div>
                        </div>
                        <div
                            style="background: linear-gradient(135deg, #fef3e2, #fce4b8); padding: 15px; border-radius: 8px; text-align: center; border: 2px solid #f39c12;">
                            <div style="color: #2c3e50; font-size: 24px; font-weight: bold;" id="total-commissions">$0
                            </div>
                            <div style="color: #2c3e50; font-size: 14px; font-weight: 600;">Comisiones Totales</div>
                        </div>
                        <div
                            style="background: rgba(155, 89, 182, 0.2); padding: 15px; border-radius: 8px; text-align: center; border: 2px solid #9b59b6;">
                            <div style="color: #2c3e50; font-size: 24px; font-weight: bold;" id="conversion-rate">0%
                            </div>
                            <div style="color: #2c3e50; font-size: 14px; font-weight: 600;">Tasa de Conversi√≥n</div>
                        </div>
                    </div>

                    <!-- Todos los paseos disponibles -->
                    <div
                        style="background: rgba(255,255,255,0.95); box-shadow: 0 8px 32px rgba(0,0,0,0.1); border-radius: 10px; padding: 20px;">
                        <h2 style="color: #2c3e50; margin-bottom: 15px;">üó∫Ô∏è Cat√°logo de Paseos</h2>
                        <div id="all-tours" class="tours-grid"
                            style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px;">
                            <!-- Cat√°logo de paseos -->
                        </div>
                    </div>

                    <!-- Reservas de paseos -->
                    <div
                        style="background: rgba(255,255,255,0.95); box-shadow: 0 8px 32px rgba(0,0,0,0.1); border-radius: 10px; padding: 20px; margin-top: 20px;">
                        <h2 style="color: #2c3e50; margin-bottom: 15px;">üìã Reservas de Paseos</h2>
                        <div id="tour-bookings">
                            <!-- Reservas de paseos se cargan aqu√≠ -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal para gesti√≥n de camas -->
        <div id="bed-modal"
            style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; align-items: center; justify-content: center;">
            <div
                style="background: linear-gradient(135deg, #2c3e50, #34495e); padding: 30px; border-radius: 15px; width: 90%; max-width: 500px; position: relative;">
                <button onclick="closeBedModal()"
                    style="position: absolute; top: 15px; right: 15px; background: none; border: none; color: #2c3e50; font-size: 24px; cursor: pointer;">√ó</button>

                <h2 id="bed-modal-title" style="color: #2c3e50; margin-bottom: 20px;">Nueva Cama</h2>

                <form id="bed-form" style="display: grid; gap: 15px;">
                    <div>
                        <label style="color: #2c3e50; display: block; margin-bottom: 5px;">Nombre de la Cama:</label>
                        <input type="text" id="bed-name" placeholder="Ej: 1-1, 2-3, Priv1-1"
                            style="width: 100%; padding: 10px; border: none; border-radius: 5px;" required>
                    </div>

                    <div>
                        <label style="color: #2c3e50; display: block; margin-bottom: 5px;">Habitaci√≥n:</label>
                        <select id="bed-room" style="width: 100%; padding: 10px; border: none; border-radius: 5px;"
                            required>
                            <option value="">Seleccionar habitaci√≥n</option>
                            <option value="Habitacion 1">Habitacion 1</option>
                            <option value="Habitacion 2">Habitacion 2</option>
                            <option value="Habitacion 3">Habitacion 3</option>
                            <option value="Habitacion 4">Habitacion 4</option>
                            <option value="Priv 1">Priv 1</option>
                            <option value="Priv 2">Priv 2</option>
                        </select>
                    </div>

                    <div>
                        <label style="color: #2c3e50; display: block; margin-bottom: 5px;">Precio por Noche ($):</label>
                        <input type="number" id="bed-price" placeholder="25.00" step="0.01" min="0"
                            style="width: 100%; padding: 10px; border: none; border-radius: 5px;" required>
                    </div>

                    <div>
                        <label style="color: #2c3e50; display: block; margin-bottom: 5px;">Estado:</label>
                        <select id="bed-status" style="width: 100%; padding: 10px; border: none; border-radius: 5px;">
                            <option value="clean">Disponible</option>
                            <option value="dirty">Por Limpiar</option>
                            <option value="occupied">Ocupada</option>
                        </select>
                    </div>

                    <div style="display: flex; gap: 10px; margin-top: 20px;">
                        <button type="button" onclick="closeBedModal()"
                            style="flex: 1; padding: 12px; background: #95a5a6; color: #2c3e50; border: none; border-radius: 5px; cursor: pointer;">
                            Cancelar
                        </button>
                        <button type="submit"
                            style="flex: 1; padding: 12px; background: #27ae60; color: white; border: none; border-radius: 5px; cursor: pointer;">
                            Guardar
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal para gesti√≥n de hu√©spedes -->
        <div id="guest-modal"
            style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; align-items: center; justify-content: center;">
            <div
                style="background: linear-gradient(135deg, #2c3e50, #34495e); padding: 30px; border-radius: 15px; width: 90%; max-width: 600px; position: relative; max-height: 90vh; overflow-y: auto;">
                <button onclick="closeGuestModal()"
                    style="position: absolute; top: 15px; right: 15px; background: none; border: none; color: #2c3e50; font-size: 24px; cursor: pointer;">√ó</button>

                <h2 id="guest-modal-title" style="color: #2c3e50; margin-bottom: 20px;">Nuevo Hu√©sped</h2>

                <form id="guest-form" style="display: grid; gap: 15px;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div>
                            <label style="color: #2c3e50; display: block; margin-bottom: 5px;">Nombre Completo:</label>
                            <input type="text" id="guest-name" placeholder="Ej: Juan Carlos P√©rez"
                                style="width: 100%; padding: 10px; border: none; border-radius: 5px;" required>
                        </div>

                        <div>
                            <label style="color: #2c3e50; display: block; margin-bottom: 5px;">Documento de
                                Identidad:</label>
                            <input type="text" id="guest-document" placeholder="Ej: 1012345678"
                                style="width: 100%; padding: 10px; border: none; border-radius: 5px;" required>
                        </div>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div>
                            <label style="color: #2c3e50; display: block; margin-bottom: 5px;">Email:</label>
                            <input type="email" id="guest-email" placeholder="nombre@email.com"
                                style="width: 100%; padding: 10px; border: none; border-radius: 5px;">
                        </div>

                        <div>
                            <label style="color: #2c3e50; display: block; margin-bottom: 5px;">Tel√©fono:</label>
                            <input type="tel" id="guest-phone" placeholder="+57 310 234 5678"
                                style="width: 100%; padding: 10px; border: none; border-radius: 5px;">
                        </div>
                    </div>

                    <div style="display: flex; gap: 10px; margin-top: 20px;">
                        <button type="button" onclick="closeGuestModal()"
                            style="flex: 1; padding: 12px; background: #95a5a6; color: #2c3e50; border: none; border-radius: 5px; cursor: pointer;">
                            Cancelar
                        </button>
                        <button type="submit"
                            style="flex: 1; padding: 12px; background: #27ae60; color: white; border: none; border-radius: 5px; cursor: pointer;">
                            Guardar
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal para detalles del hu√©sped -->
        <div id="guest-details-modal"
            style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; align-items: center; justify-content: center;">
            <div
                style="background: linear-gradient(135deg, #2c3e50, #34495e); padding: 30px; border-radius: 15px; width: 90%; max-width: 700px; position: relative; max-height: 90vh; overflow-y: auto;">
                <button onclick="closeGuestDetailsModal()"
                    style="position: absolute; top: 15px; right: 15px; background: none; border: none; color: #2c3e50; font-size: 24px; cursor: pointer;">√ó</button>

                <h2 style="color: #2c3e50; margin-bottom: 20px;">üìã Detalles del Hu√©sped</h2>

                <div id="guest-details-content">
                    <!-- Contenido del hu√©sped se carga aqu√≠ -->
                </div>
            </div>
        </div>

        <!-- Modal para gesti√≥n de productos -->
        <div id="product-modal"
            style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; align-items: center; justify-content: center;">
            <div
                style="background: linear-gradient(135deg, #2c3e50, #34495e); padding: 30px; border-radius: 15px; width: 90%; max-width: 500px; position: relative;">
                <button onclick="closeProductModal()"
                    style="position: absolute; top: 15px; right: 15px; background: none; border: none; color: #2c3e50; font-size: 24px; cursor: pointer;">√ó</button>

                <h2 id="product-modal-title" style="color: #2c3e50; margin-bottom: 20px;">Nuevo Producto</h2>

                <form id="product-form" style="display: grid; gap: 15px;">
                    <div>
                        <label style="color: #2c3e50; display: block; margin-bottom: 5px;">Nombre del Producto:</label>
                        <input type="text" id="product-name" placeholder="Ej: Caf√© Colombiano"
                            style="width: 100%; padding: 10px; border: none; border-radius: 5px;" required>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div>
                            <label style="color: #2c3e50; display: block; margin-bottom: 5px;">Precio:</label>
                            <input type="number" id="product-price" placeholder="2.50" step="0.50"
                                style="width: 100%; padding: 10px; border: none; border-radius: 5px;" required>
                        </div>

                        <div>
                            <label style="color: #2c3e50; display: block; margin-bottom: 5px;">Stock:</label>
                            <input type="number" id="product-stock" placeholder="50"
                                style="width: 100%; padding: 10px; border: none; border-radius: 5px;" required>
                        </div>
                    </div>

                    <div>
                        <label style="color: #2c3e50; display: block; margin-bottom: 5px;">Categor√≠a:</label>
                        <select id="product-category"
                            style="width: 100%; padding: 10px; border: none; border-radius: 5px;" required>
                            <option value="">Seleccionar categor√≠a</option>
                            <option value="Bebidas">Bebidas</option>
                            <option value="Comida">Comida</option>
                            <option value="Snacks">Snacks</option>
                            <option value="Otros">Otros</option>
                        </select>
                    </div>

                    <div style="display: flex; gap: 10px; margin-top: 20px;">
                        <button type="button" onclick="closeProductModal()"
                            style="flex: 1; padding: 12px; background: #95a5a6; color: #2c3e50; border: none; border-radius: 5px; cursor: pointer;">
                            Cancelar
                        </button>
                        <button type="submit"
                            style="flex: 1; padding: 12px; background: #27ae60; color: white; border: none; border-radius: 5px; cursor: pointer;">
                            Guardar
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal para gesti√≥n de personal -->
        <div id="staff-modal"
            style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; align-items: center; justify-content: center;">
            <div
                style="background: linear-gradient(135deg, #2c3e50, #34495e); padding: 30px; border-radius: 15px; width: 90%; max-width: 600px; position: relative; max-height: 90vh; overflow-y: auto;">
                <button onclick="closeStaffModal()"
                    style="position: absolute; top: 15px; right: 15px; background: none; border: none; color: #2c3e50; font-size: 24px; cursor: pointer;">√ó</button>

                <h2 id="staff-modal-title" style="color: #2c3e50; margin-bottom: 20px;">Nuevo Empleado</h2>

                <form id="staff-form" style="display: grid; gap: 15px;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div>
                            <label style="color: #2c3e50; display: block; margin-bottom: 5px;">Nombre Completo:</label>
                            <input type="text" id="staff-name" placeholder="Ej: Juan Carlos P√©rez"
                                style="width: 100%; padding: 10px; border: none; border-radius: 5px;" required>
                        </div>

                        <div>
                            <label style="color: #2c3e50; display: block; margin-bottom: 5px;">Cargo:</label>
                            <select id="staff-position"
                                style="width: 100%; padding: 10px; border: none; border-radius: 5px;" required>
                                <option value="">Seleccionar cargo</option>
                                <option value="Recepcionista">Recepcionista</option>
                                <option value="Limpieza">Limpieza</option>
                                <option value="Seguridad">Seguridad</option>
                                <option value="Mantenimiento">Mantenimiento</option>
                                <option value="Gerente">Gerente</option>
                                <option value="Contador">Contador</option>
                            </select>
                        </div>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div>
                            <label style="color: #2c3e50; display: block; margin-bottom: 5px;">Tel√©fono:</label>
                            <input type="tel" id="staff-phone" placeholder="+57 310 234 5678"
                                style="width: 100%; padding: 10px; border: none; border-radius: 5px;">
                        </div>

                        <div>
                            <label style="color: #2c3e50; display: block; margin-bottom: 5px;">Email:</label>
                            <input type="email" id="staff-email" placeholder="empleado@almanik.com"
                                style="width: 100%; padding: 10px; border: none; border-radius: 5px;">
                        </div>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div>
                            <label style="color: #2c3e50; display: block; margin-bottom: 5px;">Salario (COP):</label>
                            <input type="number" id="staff-salary" placeholder="1200000"
                                style="width: 100%; padding: 10px; border: none; border-radius: 5px;">
                        </div>

                        <div>
                            <label style="color: #2c3e50; display: block; margin-bottom: 5px;">Horario:</label>
                            <input type="text" id="staff-schedule" placeholder="Ej: Ma√±ana: 6:00-14:00"
                                style="width: 100%; padding: 10px; border: none; border-radius: 5px;">
                        </div>
                    </div>

                    <div style="display: flex; gap: 10px; margin-top: 20px;">
                        <button type="button" onclick="closeStaffModal()"
                            style="flex: 1; padding: 12px; background: #95a5a6; color: #2c3e50; border: none; border-radius: 5px; cursor: pointer;">
                            Cancelar
                        </button>
                        <button type="submit"
                            style="flex: 1; padding: 12px; background: #27ae60; color: white; border: none; border-radius: 5px; cursor: pointer;">
                            Guardar
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal para gesti√≥n de tours -->
        <div id="tour-modal"
            style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; align-items: center; justify-content: center;">
            <div
                style="background: linear-gradient(135deg, #2c3e50, #34495e); padding: 30px; border-radius: 15px; width: 90%; max-width: 700px; position: relative; max-height: 90vh; overflow-y: auto;">
                <button onclick="closeTourModal()"
                    style="position: absolute; top: 15px; right: 15px; background: none; border: none; color: #2c3e50; font-size: 24px; cursor: pointer;">√ó</button>

                <h2 id="tour-modal-title" style="color: #2c3e50; margin-bottom: 20px;">Nuevo Tour</h2>

                <form id="tour-form" style="display: grid; gap: 15px;">
                    <div>
                        <label style="color: #2c3e50; display: block; margin-bottom: 5px;">Nombre del Tour:</label>
                        <input type="text" id="tour-name" placeholder="Ej: City Tour Medell√≠n"
                            style="width: 100%; padding: 10px; border: none; border-radius: 5px;" required>
                    </div>

                    <div>
                        <label style="color: #2c3e50; display: block; margin-bottom: 5px;">Descripci√≥n:</label>
                        <textarea id="tour-description" placeholder="Describe el tour completo..."
                            style="width: 100%; padding: 10px; border: none; border-radius: 5px; height: 100px;"
                            required></textarea>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
                        <div>
                            <label style="color: #2c3e50; display: block; margin-bottom: 5px;">Precio (COP):</label>
                            <input type="number" id="tour-price" placeholder="65000"
                                style="width: 100%; padding: 10px; border: none; border-radius: 5px;" required>
                        </div>

                        <div>
                            <label style="color: #2c3e50; display: block; margin-bottom: 5px;">Duraci√≥n:</label>
                            <input type="text" id="tour-duration" placeholder="6 horas"
                                style="width: 100%; padding: 10px; border: none; border-radius: 5px;" required>
                        </div>

                        <div>
                            <label style="color: #2c3e50; display: block; margin-bottom: 5px;">Comisi√≥n (%):</label>
                            <input type="number" id="tour-commission" placeholder="15" min="0" max="50"
                                style="width: 100%; padding: 10px; border: none; border-radius: 5px;" required>
                        </div>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div>
                            <label style="color: #2c3e50; display: block; margin-bottom: 5px;">Proveedor:</label>
                            <input type="text" id="tour-provider" placeholder="Ej: TurMedell√≠n"
                                style="width: 100%; padding: 10px; border: none; border-radius: 5px;" required>
                        </div>

                        <div>
                            <label style="color: #2c3e50; display: block; margin-bottom: 5px;">URL de Reserva:</label>
                            <input type="url" id="tour-url" placeholder="https://turismo-medellin.com/city-tour"
                                style="width: 100%; padding: 10px; border: none; border-radius: 5px;" required>
                        </div>
                    </div>

                    <div style="display: flex; gap: 10px; margin-top: 20px;">
                        <button type="button" onclick="closeTourModal()"
                            style="flex: 1; padding: 12px; background: #95a5a6; color: #2c3e50; border: none; border-radius: 5px; cursor: pointer;">
                            Cancelar
                        </button>
                        <button type="submit"
                            style="flex: 1; padding: 12px; background: #27ae60; color: white; border: none; border-radius: 5px; cursor: pointer;">
                            Guardar
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <script>
            // Global variables
            let sessionId = localStorage.getItem('sessionId');
            let currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
            const API_BASE = '/api';

            // Role-based permission system
            const ROLE_PERMISSIONS = {
                'administrador': {
                    modules: ['dashboard', 'beds', 'guests', 'pos', 'staff', 'cash', 'reports', 'tours', 'users'],
                    actions: ['create', 'read', 'update', 'delete']
                },
                'recepcionista': {
                    modules: ['dashboard', 'beds', 'guests', 'pos', 'reports'],
                    actions: ['create', 'read', 'update']
                },
                'voluntario': {
                    modules: ['dashboard', 'guests', 'pos', 'tours'],
                    actions: ['read']
                }
            };

            // Check if user has permission for module
            function hasModuleAccess(module) {
                if (!currentUser.role) return false;
                return ROLE_PERMISSIONS[currentUser.role]?.modules.includes(module) || false;
            }

            // Check if user has action permission
            function hasActionPermission(action) {
                if (!currentUser.role) return false;
                return ROLE_PERMISSIONS[currentUser.role]?.actions.includes(action) || false;
            }

            // Setup UI based on user role
            function setupRoleBasedUI() {
                if (!currentUser.role) return;

                // Hide/show navigation buttons based on role
                const navButtons = {
                    'dashboard': document.querySelector('button[onclick="showView(\'dashboard\')"]'),
                    'beds': document.querySelector('button[onclick="showView(\'beds\')"]'),
                    'guests': document.querySelector('button[onclick="showView(\'guests\')"]'),
                    'pos': document.querySelector('button[onclick="showView(\'pos\')"]'),
                    'staff': document.querySelector('button[onclick="showView(\'staff\')"]'),
                    'cash': document.querySelector('button[onclick="showView(\'cash\')"]'),
                    'reports': document.querySelector('button[onclick="showView(\'reports\')"]'),
                    'tours': document.querySelector('button[onclick="showView(\'tours\')"]'),
                    'users': document.getElementById('users-nav')
                };

                // Show/hide buttons based on permissions
                Object.keys(navButtons).forEach(module => {
                    const button = navButtons[module];
                    if (button) {
                        button.style.display = hasModuleAccess(module) ? 'flex' : 'none';
                    }
                });

                // Update user info in header
                updateUserHeader();
            }

            // Update user info display
            function updateUserHeader() {
                const userInfo = document.getElementById('user-info');
                if (userInfo && currentUser.name) {
                    userInfo.innerHTML = `
                    <i class="fas fa-user-circle"></i>
                    <span>${currentUser.name}</span>
                    <small style="opacity: 0.7;">${currentUser.role}</small>
                `;
                }
            }

            // Mobile menu toggle function
            function toggleSidebar() {
                const sidebar = document.querySelector('.sidebar');
                const hamburger = document.querySelector('.hamburger');

                sidebar.classList.toggle('active');
                hamburger.classList.toggle('active');

                // Close sidebar when clicking outside on mobile
                if (sidebar.classList.contains('active')) {
                    document.addEventListener('click', closeSidebarOnOutsideClick);
                } else {
                    document.removeEventListener('click', closeSidebarOnOutsideClick);
                }
            }

            function closeSidebarOnOutsideClick(event) {
                const sidebar = document.querySelector('.sidebar');
                const hamburger = document.querySelector('.hamburger');

                if (!sidebar.contains(event.target) && !hamburger.contains(event.target)) {
                    sidebar.classList.remove('active');
                    hamburger.classList.remove('active');
                    document.removeEventListener('click', closeSidebarOnOutsideClick);
                }
            }

            // Initialize application
            document.addEventListener('DOMContentLoaded', function () {
                if (sessionId) {
                    showMainApp();
                } else {
                    showLoginScreen();
                }
            });

            // Authentication
            function showLoginScreen() {
                document.getElementById('login-screen').classList.remove('hidden');
                document.getElementById('main-app').classList.add('hidden');
            }

            function showMainApp() {
                document.getElementById('login-screen').classList.add('hidden');
                document.getElementById('main-app').classList.remove('hidden');
                loadDashboardData();
                updateTime();
                setInterval(updateTime, 1000);
                initCharts();
            }

            function logout() {
                sessionId = null;
                localStorage.removeItem('sessionId');
                showLoginScreen();
            }

            // Login form handling
            document.getElementById('login-form').addEventListener('submit', async function (e) {
                e.preventDefault();

                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;
                const loginBtn = document.getElementById('login-btn');
                const errorDiv = document.getElementById('login-error');

                loginBtn.disabled = true;
                loginBtn.textContent = 'INGRESANDO...';
                errorDiv.classList.add('hidden');

                try {
                    const response = await fetch(`${API_BASE}/login`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ username, password })
                    });

                    const data = await response.json();

                    if (data.success) {
                        sessionId = data.sessionId;
                        localStorage.setItem('sessionId', sessionId);
                        showMainApp();
                    } else {
                        errorDiv.textContent = data.message || 'Error de autenticaci√≥n';
                        errorDiv.classList.remove('hidden');
                    }
                } catch (err) {
                    errorDiv.textContent = 'Error de conexi√≥n. Verifique que el servidor est√© ejecut√°ndose.';
                    errorDiv.classList.remove('hidden');
                }

                loginBtn.disabled = false;
                loginBtn.textContent = 'INGRESAR AL SISTEMA';
            });

            // API call helper
            async function apiCall(endpoint) {
                try {
                    const response = await fetch(`${API_BASE}${endpoint}`, {
                        headers: { 'session-id': sessionId }
                    });

                    if (response.status === 401) {
                        logout();
                        return null;
                    }

                    return response.json();
                } catch (err) {
                    console.error('API call failed:', err);
                    return null;
                }
            }

            // Load dashboard data
            async function loadDashboardData() {
                const [bedsData, dashboardData] = await Promise.all([
                    apiCall('/beds'),
                    apiCall('/dashboard')
                ]);

                if (bedsData) {
                    updateBedStats(bedsData);
                    renderBeds(bedsData);
                }

                if (dashboardData) {
                    updateRevenue(dashboardData);
                }

                loadRecentActivity();
            }

            // Update bed statistics
            function updateBedStats(beds) {
                const occupied = beds.filter(b => b.status === 'occupied').length;
                const clean = beds.filter(b => b.status === 'clean').length;
                const dirty = beds.filter(b => b.status === 'dirty').length;
                const total = beds.length;

                document.getElementById('occupied-count').textContent = occupied;
                document.getElementById('clean-count').textContent = clean;
                document.getElementById('dirty-count').textContent = dirty;

                // Update progress bars
                const occupancyRate = Math.round((occupied / total) * 100);
                const cleanRate = Math.round((clean / total) * 100);
                const dirtyRate = Math.round((dirty / total) * 100);

                document.getElementById('occupied-progress').style.width = `${occupancyRate}%`;
                document.getElementById('clean-progress').style.width = `${cleanRate}%`;
                document.getElementById('dirty-progress').style.width = `${dirtyRate}%`;
                document.getElementById('occupancy-rate').textContent = `${occupancyRate}%`;
            }

            // Update revenue
            function updateRevenue(data) {
                if (data.todayRevenue !== undefined) {
                    const formatted = new Intl.NumberFormat('es-CO').format(data.todayRevenue * 1000);
                    document.getElementById('revenue-amount').textContent = `$${formatted}`;
                }
            }

            // Render beds
            function renderBeds(beds) {
                const dormBeds = beds.filter(b => b.name.includes('A') || b.name.includes('B'));
                const privateBeds = beds.filter(b => b.name.includes('PR') || b.name.includes('Private'));

                renderBedGrid('dorm-beds', dormBeds);
                renderBedGrid('private-beds', privateBeds);
            }

            function renderBedGrid(containerId, beds) {
                const container = document.getElementById(containerId);
                container.innerHTML = '';

                beds.forEach(bed => {
                    const bedElement = document.createElement('div');
                    bedElement.className = `bed-status ${bed.status}`;
                    bedElement.innerHTML = `
                    <div class="bed-number">${bed.name}</div>
                    <div class="bed-guest">${bed.guest_name || 'Disponible'}</div>
                `;

                    bedElement.addEventListener('click', () => {
                        let message = '';
                        if (bed.status === 'clean') {
                            message = `Cama ${bed.name} disponible para check-in`;
                        } else if (bed.status === 'occupied') {
                            message = `Cama ${bed.name} - Hu√©sped: ${bed.guest_name}`;
                        } else if (bed.status === 'dirty') {
                            message = `Cama ${bed.name} necesita limpieza`;
                        }
                        alert(message);
                    });

                    container.appendChild(bedElement);
                });
            }

            // Load recent activity (sample data)
            function loadRecentActivity() {
                const activities = [
                    {
                        type: 'checkin',
                        icon: 'fas fa-user-plus',
                        title: 'Nuevo Check-in',
                        desc: 'Juan Carlos P√©rez se registr√≥ en Cama A2',
                        time: '5 minutos',
                        gradient: 'checkin'
                    },
                    {
                        type: 'sale',
                        icon: 'fas fa-shopping-cart',
                        title: 'Venta POS',
                        desc: 'Cerveza √Åguila x2 vendida a Habitaci√≥n B2',
                        time: '12 minutos',
                        gradient: 'sale'
                    },
                    {
                        type: 'payment',
                        icon: 'fas fa-credit-card',
                        title: 'Pago Recibido',
                        desc: '$45.000 pago por Cama A1 - Mar√≠a Gonz√°lez',
                        time: '25 minutos',
                        gradient: 'payment'
                    },
                    {
                        type: 'checkout',
                        icon: 'fas fa-user-minus',
                        title: 'Check-out',
                        desc: 'Carlos Silva complet√≥ check-out de Cama B3',
                        time: '45 minutos',
                        gradient: 'checkout'
                    },
                    {
                        type: 'checkin',
                        icon: 'fas fa-user-plus',
                        title: 'Nuevo Check-in',
                        desc: 'Ana Rodr√≠guez se registr√≥ en Habitaci√≥n Privada 1',
                        time: '1 hora',
                        gradient: 'checkin'
                    }
                ];

                const container = document.getElementById('activity-list');
                container.innerHTML = '';

                activities.forEach(activity => {
                    const activityElement = document.createElement('div');
                    activityElement.className = 'activity-item';
                    activityElement.innerHTML = `
                    <div class="activity-icon ${activity.gradient}">
                        <i class="${activity.icon}"></i>
                    </div>
                    <div class="activity-content">
                        <div class="activity-title">${activity.title}</div>
                        <div class="activity-desc">${activity.desc}</div>
                        <div class="activity-time">hace ${activity.time}</div>
                    </div>
                `;
                    container.appendChild(activityElement);
                });
            }

            // Update time
            function updateTime() {
                const now = new Date();
                const timeString = now.toLocaleTimeString('es-CO', {
                    hour: '2-digit',
                    minute: '2-digit',
                    hour12: true
                });
                const dateString = now.toLocaleDateString('es-CO', {
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });

                document.getElementById('current-time').textContent = timeString;
                document.getElementById('current-date').textContent = dateString;
            }

            // Navigation
            function showView(viewName) {
                // Close mobile sidebar when navigation item is clicked
                const sidebar = document.querySelector('.sidebar');
                const hamburger = document.querySelector('.hamburger');
                if (sidebar && hamburger) {
                    sidebar.classList.remove('active');
                    hamburger.classList.remove('active');
                    document.removeEventListener('click', closeSidebarOnOutsideClick);
                }

                // Hide all views
                document.querySelectorAll('[id$="-view"]').forEach(view => {
                    view.classList.add('hidden');
                });

                // Show selected view
                document.getElementById(viewName + '-view').classList.remove('hidden');

                // Update navigation buttons
                document.querySelectorAll('.nav-button').forEach(btn => {
                    btn.classList.remove('active');
                });
                if (event && event.target) {
                    event.target.classList.add('active');
                }

                // Handle specific view actions
                if (viewName === 'beds') {
                    checkPreselectedGuest();
                } else if (viewName === 'guests') {
                    refreshGuests();
                } else if (viewName === 'pos') {
                    loadProducts();
                } else if (viewName === 'staff') {
                    loadStaff();
                } else if (viewName === 'tours') {
                    loadTours();
                }
            }

            // Initialize charts
            function initCharts() {
                // Occupancy Chart
                const occupancyCtx = document.getElementById('occupancyChart').getContext('2d');
                new Chart(occupancyCtx, {
                    type: 'line',
                    data: {
                        labels: ['Lun', 'Mar', 'Mi√©', 'Jue', 'Vie', 'S√°b', 'Dom'],
                        datasets: [{
                            label: 'Tasa de Ocupaci√≥n (%)',
                            data: [65, 78, 82, 89, 95, 92, 87],
                            borderColor: 'rgba(46, 204, 113, 1)',
                            backgroundColor: 'rgba(46, 204, 113, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4,
                            pointBackgroundColor: 'rgba(46, 204, 113, 1)',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2,
                            pointRadius: 6
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        aspectRatio: 2.5,
                        plugins: {
                            legend: {
                                labels: {
                                    color: 'white',
                                    font: { size: 14 }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100,
                                ticks: {
                                    color: 'rgba(255, 255, 255, 0.8)',
                                    font: { size: 12 }
                                },
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                }
                            },
                            x: {
                                ticks: {
                                    color: 'rgba(255, 255, 255, 0.8)',
                                    font: { size: 12 }
                                },
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                }
                            }
                        }
                    }
                });

                // Revenue Chart
                const revenueCtx = document.getElementById('revenueChart').getContext('2d');
                new Chart(revenueCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Alojamiento', 'Ventas POS', 'Tours', 'Lavander√≠a'],
                        datasets: [{
                            data: [1850000, 400000, 200000, 100000],
                            backgroundColor: [
                                'rgba(52, 152, 219, 0.8)',
                                'rgba(46, 204, 113, 0.8)',
                                'rgba(243, 156, 18, 0.8)',
                                'rgba(155, 89, 182, 0.8)'
                            ],
                            borderColor: [
                                'rgba(52, 152, 219, 1)',
                                'rgba(46, 204, 113, 1)',
                                'rgba(243, 156, 18, 1)',
                                'rgba(155, 89, 182, 1)'
                            ],
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        aspectRatio: 1,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    color: 'white',
                                    font: { size: 12 },
                                    padding: 15
                                }
                            }
                        }
                    }
                });
            }

            // ============= CAMAS FUNCTIONALITY =============
            let currentEditingBed = null;

            async function refreshBeds() {
                try {
                    const response = await apiCall('/beds/by-room');
                    if (response) {
                        renderBedsByRoom(response);
                        updateBedsSummary(response);
                    }
                } catch (error) {
                    console.error('Error loading beds:', error);
                }
            }

            function renderBedsByRoom(bedsByRoom) {
                const container = document.getElementById('rooms-container');
                container.innerHTML = '';

                Object.keys(bedsByRoom).forEach(roomName => {
                    const beds = bedsByRoom[roomName];
                    const roomDiv = document.createElement('div');
                    roomDiv.style.marginBottom = '30px';

                    const roomIcon = roomName.includes('Priv') ? 'üö™' : 'üè†';

                    roomDiv.innerHTML = `
                    <h2 style="color: #2c3e50; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                        ${roomIcon} ${roomName}
                        <span style="font-size: 14px; background: rgba(255,255,255,0.95); box-shadow: 0 4px 16px rgba(0,0,0,0.05); padding: 5px 10px; border-radius: 15px;">
                            ${beds.length} camas
                        </span>
                    </h2>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 15px;">
                        ${beds.map(bed => `
                            <div style="
                                background: ${getBedCardBackground(bed.status)};
                                border-radius: 15px;
                                padding: 20px;
                                border: 2px solid ${getBedColor(bed.status)};
                                box-shadow: 0 8px 25px rgba(0,0,0,0.3);
                                backdrop-filter: blur(10px);
                                transition: all 0.3s ease;
                                position: relative;
                                overflow: hidden;
                            " onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 12px 35px rgba(0,0,0,0.4)'"
                               onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 8px 25px rgba(0,0,0,0.3)'">
                                <!-- Status indicator -->
                                <div style="position: absolute; top: 15px; right: 15px; width: 12px; height: 12px; border-radius: 50%; background: ${getBedColor(bed.status)}; box-shadow: 0 0 10px ${getBedColor(bed.status)};"></div>

                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                    <h3 style="color: #2c3e50; margin: 0; font-size: 18px; font-weight: bold;">üõèÔ∏è ${bed.name}</h3>
                                    <button onclick="showEditBedModal(${bed.id})" style="background: linear-gradient(135deg, #fef3e2, #fce4b8); border: 1px solid #f39c12; color: #f39c12; cursor: pointer; font-size: 14px; padding: 6px 8px; border-radius: 8px; transition: all 0.3s ease;" title="Editar">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                </div>

                                <div style="background: rgba(0,0,0,0.2); padding: 10px; border-radius: 8px; margin-bottom: 15px;">
                                    <p style="color: #2c3e50; margin: 5px 0; display: flex; align-items: center; gap: 8px;">
                                        <span style="font-size: 12px;">‚ö°</span>
                                        Estado: <strong style="color: ${getBedColor(bed.status)}; text-shadow: 0 0 5px ${getBedColor(bed.status)};">${getBedStatusText(bed.status)}</strong>
                                    </p>
                                    <p style="color: #2c3e50; margin: 5px 0; display: flex; align-items: center; gap: 8px;">
                                        <span style="font-size: 12px;">üí∞</span>
                                        Precio: <strong style="color: #f1c40f;">$${bed.price}</strong>
                                    </p>
                                    ${bed.guest_name ? `<p style="color: #2c3e50; margin: 5px 0; display: flex; align-items: center; gap: 8px;"><span style="font-size: 12px;">üë§</span>Hu√©sped: <strong style="color: #3498db;">${bed.guest_name}</strong></p>` : ''}
                                </div>

                                <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                                    ${getBedActions(bed)}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
                    container.appendChild(roomDiv);
                });
            }

            function updateBedsSummary(bedsByRoom) {
                let totalBeds = 0;
                let cleanBeds = 0;
                let occupiedBeds = 0;
                let dirtyBeds = 0;

                Object.values(bedsByRoom).forEach(beds => {
                    beds.forEach(bed => {
                        totalBeds++;
                        if (bed.status === 'clean') cleanBeds++;
                        else if (bed.status === 'occupied') occupiedBeds++;
                        else if (bed.status === 'dirty') dirtyBeds++;
                    });
                });

                document.getElementById('total-beds-count').textContent = totalBeds;
                document.getElementById('clean-beds-count').textContent = cleanBeds;
                document.getElementById('occupied-beds-count').textContent = occupiedBeds;
                document.getElementById('dirty-beds-count').textContent = dirtyBeds;
            }

            function getBedColor(status) {
                switch (status) {
                    case 'clean': return '#27ae60';
                    case 'occupied': return '#e74c3c';
                    case 'dirty': return '#f39c12';
                    default: return '#95a5a6';
                }
            }

            function getBedCardBackground(status) {
                switch (status) {
                    case 'clean': return 'linear-gradient(135deg, rgba(39, 174, 96, 0.2), rgba(46, 204, 113, 0.1))';
                    case 'occupied': return 'linear-gradient(135deg, rgba(231, 76, 60, 0.2), rgba(192, 57, 43, 0.1))';
                    case 'dirty': return 'linear-gradient(135deg, rgba(243, 156, 18, 0.2), rgba(230, 126, 34, 0.1))';
                    default: return 'linear-gradient(135deg, rgba(149, 165, 166, 0.2), rgba(127, 140, 141, 0.1))';
                }
            }

            function getBedStatusText(status) {
                switch (status) {
                    case 'clean': return 'Disponible';
                    case 'occupied': return 'Ocupada';
                    case 'dirty': return 'Por Limpiar';
                    default: return 'Desconocido';
                }
            }

            function getBedActions(bed) {
                let actions = [];

                const buttonBaseStyle = "padding: 10px 15px; border: none; border-radius: 8px; cursor: pointer; font-size: 12px; font-weight: bold; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(0,0,0,0.2); text-transform: uppercase; letter-spacing: 0.5px;";

                if (bed.status === 'clean') {
                    const selectedGuestId = localStorage.getItem('selectedGuestForCheckin');
                    actions.push(`
                    <button onclick="startCheckin(${bed.id}, ${selectedGuestId || 'null'})"
                            style="${buttonBaseStyle} background: linear-gradient(135deg, #3498db, #2980b9); color: #2c3e50;"
                            onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(52, 152, 219, 0.4)'"
                            onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(0,0,0,0.2)'">
                        üè® Check-in
                    </button>
                `);
                } else if (bed.status === 'dirty') {
                    actions.push(`
                    <button onclick="markClean(${bed.id})"
                            style="${buttonBaseStyle} background: linear-gradient(135deg, #27ae60, #229954); color: #2c3e50;"
                            onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(39, 174, 96, 0.4)'"
                            onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(0,0,0,0.2)'">
                        ‚ú® Disponible
                    </button>
                `);
                } else if (bed.status === 'occupied') {
                    actions.push(`
                    <button onclick="startCheckout(${bed.id})"
                            style="${buttonBaseStyle} background: linear-gradient(135deg, #e74c3c, #c0392b); color: #2c3e50;"
                            onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(231, 76, 60, 0.4)'"
                            onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(0,0,0,0.2)'">
                        üö™ Check-out
                    </button>
                `);
                }

                // Siempre agregar bot√≥n de eliminar (si no est√° ocupada)
                if (bed.status !== 'occupied') {
                    actions.push(`
                    <button onclick="deleteBed(${bed.id})"
                            style="${buttonBaseStyle} background: linear-gradient(135deg, #e67e22, #d35400); color: #2c3e50; padding: 10px 12px;"
                            onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(230, 126, 34, 0.4)'"
                            onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(0,0,0,0.2)'"
                            title="Eliminar Cama">
                        üóëÔ∏è
                    </button>
                `);
                }

                return actions.join('');
            }

            // ============= MODAL FUNCTIONALITY =============
            function showAddBedModal() {
                currentEditingBed = null;
                document.getElementById('bed-modal-title').textContent = 'Nueva Cama';
                document.getElementById('bed-form').reset();
                document.getElementById('bed-modal').style.display = 'flex';
            }

            async function showEditBedModal(bedId) {
                try {
                    const beds = await apiCall('/beds');
                    const bed = beds.find(b => b.id === bedId);

                    if (bed) {
                        currentEditingBed = bed;
                        document.getElementById('bed-modal-title').textContent = 'Editar Cama';
                        document.getElementById('bed-name').value = bed.name;
                        document.getElementById('bed-room').value = bed.room || '';
                        document.getElementById('bed-price').value = bed.price;
                        document.getElementById('bed-status').value = bed.status;
                        document.getElementById('bed-modal').style.display = 'flex';
                    }
                } catch (error) {
                    alert('Error al cargar datos de la cama');
                }
            }

            function closeBedModal() {
                document.getElementById('bed-modal').style.display = 'none';
                currentEditingBed = null;
            }

            // Form handler
            document.getElementById('bed-form').addEventListener('submit', async function (e) {
                e.preventDefault();

                const formData = {
                    name: document.getElementById('bed-name').value,
                    room: document.getElementById('bed-room').value,
                    price: parseFloat(document.getElementById('bed-price').value),
                    status: document.getElementById('bed-status').value
                };

                try {
                    if (currentEditingBed) {
                        // Editar cama existente
                        await apiCall(`/beds/${currentEditingBed.id}`, {
                            method: 'PUT',
                            body: JSON.stringify(formData)
                        });
                        alert('Cama actualizada exitosamente');
                    } else {
                        // Crear nueva cama
                        await apiCall('/beds', {
                            method: 'POST',
                            body: JSON.stringify(formData)
                        });
                        alert('Cama creada exitosamente');
                    }

                    closeBedModal();
                    refreshBeds();
                } catch (error) {
                    alert('Error al guardar la cama: ' + (error.message || 'Error desconocido'));
                }
            });

            // Guest form handling
            document.getElementById('guest-form').addEventListener('submit', async function (e) {
                e.preventDefault();

                const formData = {
                    name: document.getElementById('guest-name').value,
                    document: document.getElementById('guest-document').value,
                    email: document.getElementById('guest-email').value,
                    phone: document.getElementById('guest-phone').value
                };

                try {
                    const guestId = this.getAttribute('data-guest-id');
                    if (guestId) {
                        // Editar hu√©sped existente
                        await apiCall(`/guests/${guestId}`, 'PUT', formData);
                        alert('Hu√©sped actualizado exitosamente');
                    } else {
                        // Crear nuevo hu√©sped
                        await apiCall('/guests', 'POST', formData);
                        alert('Hu√©sped creado exitosamente');
                    }

                    closeGuestModal();
                    refreshGuests();
                } catch (error) {
                    console.error('Error saving guest:', error);
                    alert('Error al guardar el hu√©sped: ' + (error.message || 'Error desconocido'));
                }
            });

            // Product form handling
            document.getElementById('product-form').addEventListener('submit', async function (e) {
                e.preventDefault();

                const formData = {
                    name: document.getElementById('product-name').value,
                    price: parseFloat(document.getElementById('product-price').value),
                    category: document.getElementById('product-category').value,
                    stock: parseInt(document.getElementById('product-stock').value)
                };

                try {
                    const productId = this.getAttribute('data-product-id');
                    if (productId) {
                        // Edit existing product
                        await apiCall(`/products/${productId}`, 'PUT', formData);
                        alert('Producto actualizado exitosamente');
                    } else {
                        // Create new product
                        await apiCall('/products', 'POST', formData);
                        alert('Producto creado exitosamente');
                    }

                    closeProductModal();
                    loadProducts();
                } catch (error) {
                    console.error('Error saving product:', error);
                    alert('Error al guardar el producto: ' + (error.message || 'Error desconocido'));
                }
            });

            // Staff form handling
            document.getElementById('staff-form').addEventListener('submit', async function (e) {
                e.preventDefault();

                const formData = {
                    name: document.getElementById('staff-name').value,
                    position: document.getElementById('staff-position').value,
                    phone: document.getElementById('staff-phone').value,
                    email: document.getElementById('staff-email').value,
                    salary: parseFloat(document.getElementById('staff-salary').value) || null,
                    schedule: document.getElementById('staff-schedule').value
                };

                try {
                    const staffId = this.getAttribute('data-staff-id');
                    if (staffId) {
                        // Edit existing staff member
                        await apiCall(`/staff/${staffId}`, 'PUT', formData);
                        alert('Empleado actualizado exitosamente');
                    } else {
                        // Create new staff member
                        await apiCall('/staff', 'POST', formData);
                        alert('Empleado creado exitosamente');
                    }

                    closeStaffModal();
                    loadStaff();
                } catch (error) {
                    console.error('Error saving staff:', error);
                    alert('Error al guardar el empleado: ' + (error.message || 'Error desconocido'));
                }
            });

            // Tour form handling
            document.getElementById('tour-form').addEventListener('submit', async function (e) {
                e.preventDefault();

                const formData = {
                    name: document.getElementById('tour-name').value,
                    description: document.getElementById('tour-description').value,
                    price: parseFloat(document.getElementById('tour-price').value),
                    duration: document.getElementById('tour-duration').value,
                    provider: document.getElementById('tour-provider').value,
                    commission_rate: parseFloat(document.getElementById('tour-commission').value),
                    booking_url: document.getElementById('tour-url').value,
                    images: [] // For now, empty array. Could be enhanced to handle image uploads
                };

                try {
                    const tourId = this.getAttribute('data-tour-id');
                    if (tourId) {
                        // Edit existing tour
                        await apiCall(`/tours/${tourId}`, 'PUT', formData);
                        alert('Tour actualizado exitosamente');
                    } else {
                        // Create new tour
                        await apiCall('/tours', 'POST', formData);
                        alert('Tour creado exitosamente');
                    }

                    closeTourModal();
                    loadTours();
                } catch (error) {
                    console.error('Error saving tour:', error);
                    alert('Error al guardar el tour: ' + (error.message || 'Error desconocido'));
                }
            });

            async function deleteBed(bedId) {
                if (confirm('¬øEst√°s seguro de que quieres eliminar esta cama?')) {
                    try {
                        await apiCall(`/beds/${bedId}`, {
                            method: 'DELETE'
                        });
                        alert('Cama eliminada exitosamente');
                        refreshBeds();
                    } catch (error) {
                        alert('Error al eliminar la cama: ' + (error.message || 'Error desconocido'));
                    }
                }
            }

            async function markClean(bedId) {
                try {
                    await apiCall(`/beds/${bedId}/status`, {
                        method: 'PUT',
                        body: JSON.stringify({ status: 'clean' })
                    });
                    refreshBeds();
                } catch (error) {
                    alert('Error al actualizar la cama');
                }
            }

            // ============= HU√âSPEDES FUNCTIONALITY =============
            let currentEditingGuest = null;

            async function refreshGuests() {
                try {
                    const [guestsResponse, statsResponse] = await Promise.all([
                        apiCall('/guests'),
                        apiCall('/guests/stats')
                    ]);

                    if (guestsResponse) {
                        renderGuestsList(guestsResponse);
                    }

                    if (statsResponse) {
                        updateGuestsStats(statsResponse);
                    }
                } catch (error) {
                    console.error('Error loading guests:', error);
                }
            }

            async function searchGuests() {
                const query = document.getElementById('guest-search').value.trim();

                if (!query) {
                    alert('Por favor ingresa un t√©rmino de b√∫squeda');
                    return;
                }

                try {
                    const response = await apiCall(`/guests/search?q=${encodeURIComponent(query)}`);
                    if (response) {
                        renderGuestsList(response);
                    }
                } catch (error) {
                    console.error('Error searching guests:', error);
                    alert('Error al buscar hu√©spedes');
                }
            }

            async function clearSearchAndLoadAll() {
                document.getElementById('guest-search').value = '';
                await refreshGuests();
            }

            function updateGuestsStats(stats) {
                document.getElementById('total-guests-count').textContent = stats.total_guests || 0;
                document.getElementById('staying-guests-count').textContent = stats.currently_staying || 0;
                document.getElementById('active-bookings-count').textContent = stats.active_bookings || 0;
            }

            function renderGuestsList(guests) {
                const container = document.getElementById('guests-container');

                if (!guests || guests.length === 0) {
                    container.innerHTML = `
                    <div style="background: rgba(255,255,255,0.95); box-shadow: 0 8px 32px rgba(0,0,0,0.1); border-radius: 10px; padding: 40px; text-align: center;">
                        <h3 style="color: #2c3e50; margin: 0 0 10px 0;">üë• No se encontraron hu√©spedes</h3>
                        <p style="color: #7f8c8d;">Intenta con otro t√©rmino de b√∫squeda o agrega un nuevo hu√©sped</p>
                    </div>
                `;
                    return;
                }

                container.innerHTML = `
                <div style="display: grid; gap: 20px;">
                    ${guests.map(guest => `
                        <div style="
                            background: ${getGuestCardBackground(guest)};
                            border-radius: 15px;
                            padding: 20px;
                            border: 2px solid ${getGuestBorderColor(guest)};
                            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
                            backdrop-filter: blur(10px);
                            transition: all 0.3s ease;
                            position: relative;
                            overflow: hidden;
                        " onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 12px 35px rgba(0,0,0,0.4)'"
                           onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 8px 25px rgba(0,0,0,0.3)'">

                            <!-- Status indicator -->
                            <div style="position: absolute; top: 15px; right: 15px; width: 12px; height: 12px; border-radius: 50%; background: ${getGuestStatusColor(guest)}; box-shadow: 0 0 10px ${getGuestStatusColor(guest)};"></div>

                            <div style="display: grid; grid-template-columns: 1fr auto; gap: 20px; align-items: center;">
                                <div>
                                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
                                        <h3 style="color: #2c3e50; margin: 0; font-size: 20px; font-weight: bold;">üë§ ${guest.name}</h3>
                                        ${guest.current_bed_name ? `<span style="background: linear-gradient(135deg, #e8f5e8, #d4ecd4); color: #27ae60; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: bold;">üõèÔ∏è ${guest.current_bed_name}</span>` : ''}
                                    </div>

                                    <div style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
                                            <p style="color: #2c3e50; margin: 5px 0; display: flex; align-items: center; gap: 8px;">
                                                <span style="font-size: 14px;">üÜî</span>
                                                <strong>Documento:</strong> ${guest.document}
                                            </p>
                                            <p style="color: #2c3e50; margin: 5px 0; display: flex; align-items: center; gap: 8px;">
                                                <span style="font-size: 14px;">üìß</span>
                                                <strong>Email:</strong> ${guest.email || 'No registrado'}
                                            </p>
                                            <p style="color: #2c3e50; margin: 5px 0; display: flex; align-items: center; gap: 8px;">
                                                <span style="font-size: 14px;">üì±</span>
                                                <strong>Tel√©fono:</strong> ${guest.phone || 'No registrado'}
                                            </p>
                                            ${guest.check_in ? `
                                                <p style="color: #2c3e50; margin: 5px 0; display: flex; align-items: center; gap: 8px;">
                                                    <span style="font-size: 14px;">üìÖ</span>
                                                    <strong>Check-in:</strong> <span style="color: #3498db;">${new Date(guest.check_in).toLocaleDateString()}</span>
                                                </p>
                                            ` : ''}
                                        </div>
                                    </div>
                                </div>

                                <div style="display: flex; flex-direction: column; gap: 10px; align-items: end;">
                                    ${getGuestActions(guest)}
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
            }

            function getGuestCardBackground(guest) {
                if (guest.current_bed_name) {
                    return 'linear-gradient(135deg, rgba(39, 174, 96, 0.2), rgba(46, 204, 113, 0.1))';
                } else {
                    return 'linear-gradient(135deg, rgba(52, 152, 219, 0.2), rgba(41, 128, 185, 0.1))';
                }
            }

            function getGuestBorderColor(guest) {
                return guest.current_bed_name ? '#27ae60' : '#3498db';
            }

            function getGuestStatusColor(guest) {
                return guest.current_bed_name ? '#27ae60' : '#3498db';
            }

            function getGuestActions(guest) {
                const buttonBaseStyle = "padding: 10px 15px; border: none; border-radius: 8px; cursor: pointer; font-size: 12px; font-weight: bold; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(0,0,0,0.2); text-transform: uppercase; letter-spacing: 0.5px; min-width: 120px;";

                let actions = [];

                // Bot√≥n de ver detalles
                actions.push(`
                <button onclick="showGuestDetails(${guest.id})"
                        style="${buttonBaseStyle} background: linear-gradient(135deg, #9b59b6, #8e44ad); color: #2c3e50;"
                        onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(155, 89, 182, 0.4)'"
                        onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(0,0,0,0.2)'">
                    üìã Detalles
                </button>
            `);

                // Bot√≥n de editar
                actions.push(`
                <button onclick="showEditGuestModal(${guest.id})"
                        style="${buttonBaseStyle} background: linear-gradient(135deg, #f39c12, #e67e22); color: #2c3e50;"
                        onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(243, 156, 18, 0.4)'"
                        onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(0,0,0,0.2)'">
                    ‚úèÔ∏è Editar
                </button>
            `);

                // Bot√≥n condicional seg√∫n estado
                if (guest.current_bed_name) {
                    actions.push(`
                    <button onclick="startCheckout(${guest.current_bed_id})"
                            style="${buttonBaseStyle} background: linear-gradient(135deg, #e74c3c, #c0392b); color: #2c3e50;"
                            onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(231, 76, 60, 0.4)'"
                            onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(0,0,0,0.2)'">
                        üö™ Check-out
                    </button>
                `);
                } else {
                    actions.push(`
                    <button onclick="selectGuestForCheckin(${guest.id})"
                            style="${buttonBaseStyle} background: linear-gradient(135deg, #3498db, #2980b9); color: #2c3e50;"
                            onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(52, 152, 219, 0.4)'"
                            onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(0,0,0,0.2)'">
                        üè® Check-in
                    </button>
                `);
                }

                // Bot√≥n de eliminar (solo si no est√° hospedado)
                if (!guest.current_bed_name) {
                    actions.push(`
                    <button onclick="deleteGuest(${guest.id})"
                            style="${buttonBaseStyle} background: linear-gradient(135deg, #e67e22, #d35400); color: #2c3e50; padding: 10px 12px; min-width: auto;"
                            onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(230, 126, 34, 0.4)'"
                            onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(0,0,0,0.2)'"
                            title="Eliminar Hu√©sped">
                        üóëÔ∏è
                    </button>
                `);
                }

                return actions.join('');
            }

            // ============= POS FUNCTIONALITY =============
            let cart = [];
            let products = [];

            async function loadProducts() {
                try {
                    const response = await apiCall('/products');
                    if (response) {
                        products = response;
                        renderProducts(response);
                    }
                } catch (error) {
                    console.error('Error loading products:', error);
                }
            }

            function renderProducts(products) {
                const container = document.getElementById('products-grid');

                if (!products || products.length === 0) {
                    container.innerHTML = `
                    <div style="grid-column: 1/-1; background: rgba(255,255,255,0.95); box-shadow: 0 8px 32px rgba(0,0,0,0.1); border-radius: 10px; padding: 40px; text-align: center;">
                        <h3 style="color: #2c3e50; margin: 0 0 10px 0;">üì¶ No hay productos disponibles</h3>
                        <p style="color: #7f8c8d;">Agrega productos para comenzar a vender</p>
                        <button onclick="showAddProductModal()" style="margin-top: 15px; padding: 10px 20px; background: #27ae60; color: white; border: none; border-radius: 5px; cursor: pointer;">
                            <i class="fas fa-plus"></i> Agregar Producto
                        </button>
                    </div>
                `;
                    return;
                }

                // Group products by category
                const categories = {};
                products.forEach(product => {
                    if (!categories[product.category]) {
                        categories[product.category] = [];
                    }
                    categories[product.category].push(product);
                });

                let html = `
                <div style="grid-column: 1/-1; display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3 style="color: #2c3e50; margin: 0;">üì¶ Productos Disponibles</h3>
                    <button onclick="showAddProductModal()" style="padding: 8px 16px; background: #27ae60; color: white; border: none; border-radius: 5px; cursor: pointer;">
                        <i class="fas fa-plus"></i> Nuevo Producto
                    </button>
                </div>
            `;

                Object.keys(categories).forEach(category => {
                    html += `
                    <div style="grid-column: 1/-1; color: #2c3e50; font-size: 18px; font-weight: bold; margin: 20px 0 10px 0; border-bottom: 2px solid rgba(255,255,255,0.3); padding-bottom: 5px;">
                        ${getCategoryIcon(category)} ${category}
                    </div>
                `;

                    categories[category].forEach(product => {
                        const isOutOfStock = product.stock <= 0;
                        const isLowStock = product.stock <= 5 && product.stock > 0;
                        html += `
                        <div style="
                            background: ${isOutOfStock ? 'rgba(231, 76, 60, 0.2)' : isLowStock ? 'rgba(243, 156, 18, 0.2)' : 'linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05))'};
                            border-radius: 12px;
                            padding: 20px;
                            text-align: center;
                            border: 2px solid ${isOutOfStock ? '#e74c3c' : isLowStock ? '#f39c12' : 'rgba(255,255,255,0.2)'};
                            position: relative;
                            transition: all 0.3s ease;
                            ${isOutOfStock ? 'filter: grayscale(50%);' : ''}
                        " onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 8px 25px rgba(0,0,0,0.3)'"
                           onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                            ${isOutOfStock ? '<div style="position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; padding: 5px 8px; border-radius: 5px; font-size: 10px; font-weight: bold;">AGOTADO</div>' : ''}
                            ${isLowStock ? '<div style="position: absolute; top: 10px; right: 10px; background: #f39c12; color: white; padding: 5px 8px; border-radius: 5px; font-size: 10px; font-weight: bold;">POCO STOCK</div>' : ''}
                            <h3 style="color: #2c3e50; margin: 0 0 10px 0; font-size: 16px;">${product.name}</h3>
                            <p style="color: ${isOutOfStock ? '#e74c3c' : '#27ae60'}; font-size: 20px; font-weight: bold; margin: 10px 0;">$${product.price.toLocaleString()}</p>
                            <p style="color: #7f8c8d; font-size: 12px; margin: 5px 0;">Stock: ${product.stock}</p>
                            <div style="display: flex; gap: 5px; margin-top: 15px;">
                                <button onclick="addToCart(${product.id}, '${product.name}', ${product.price})"
                                        ${isOutOfStock ? 'disabled' : ''}
                                        style="flex: 1; padding: 8px; background: ${isOutOfStock ? '#95a5a6' : '#27ae60'}; color: #2c3e50; border: none; border-radius: 5px; cursor: ${isOutOfStock ? 'not-allowed' : 'pointer'}; font-size: 12px;">
                                    ${isOutOfStock ? '‚ùå Agotado' : 'üõí Agregar'}
                                </button>
                                <button onclick="showEditProductModal(${product.id})" style="padding: 8px 12px; background: #3498db; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 12px;">
                                    ‚úèÔ∏è
                                </button>
                                <button onclick="deleteProduct(${product.id})" style="padding: 8px 12px; background: #e74c3c; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 12px;">
                                    üóëÔ∏è
                                </button>
                            </div>
                        </div>
                    `;
                    });
                });

                container.innerHTML = html;
            }

            function getCategoryIcon(category) {
                const icons = {
                    'Bebidas': 'ü•§',
                    'Comida': 'üçΩÔ∏è',
                    'Snacks': 'üçø',
                    'Otros': 'üì¶'
                };
                return icons[category] || 'üì¶';
            }

            function addToCart(id, name, price) {
                const product = products.find(p => p.id === id);
                if (!product || product.stock <= 0) {
                    alert('Producto agotado');
                    return;
                }

                const existingItem = cart.find(item => item.id === id);
                if (existingItem) {
                    if (existingItem.quantity >= product.stock) {
                        alert(`Solo hay ${product.stock} unidades disponibles`);
                        return;
                    }
                    existingItem.quantity += 1;
                } else {
                    cart.push({ id, name, price, quantity: 1, stock: product.stock });
                }
                updateCartDisplay();
            }

            function updateCartDisplay() {
                const container = document.getElementById('cart-items');
                const totalElement = document.getElementById('cart-total');

                if (cart.length === 0) {
                    container.innerHTML = `
                    <div style="text-align: center; padding: 20px;">
                        <p style="color: #7f8c8d;">üõí Carrito vac√≠o</p>
                        <p style="color: #bdc3c7; font-size: 12px;">Agrega productos para comenzar</p>
                    </div>
                `;
                    totalElement.textContent = '0';
                    return;
                }

                const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);

                container.innerHTML = cart.map(item => `
                <div style="
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 12px;
                    background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
                    border-radius: 8px;
                    margin-bottom: 8px;
                    border: 1px solid rgba(255,255,255,0.2);
                ">
                    <div style="flex: 1;">
                        <div style="color: #2c3e50; font-weight: bold; font-size: 14px;">${item.name}</div>
                        <div style="color: #7f8c8d; font-size: 11px;">$${item.price.toLocaleString()} c/u</div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <button onclick="removeFromCart(${item.id})" style="background: #e74c3c; color: white; border: none; border-radius: 4px; width: 24px; height: 24px; cursor: pointer; font-size: 12px;">‚àí</button>
                        <span style="color: #2c3e50; font-weight: bold; min-width: 20px; text-align: center;">${item.quantity}</span>
                        <button onclick="addToCart(${item.id}, '${item.name}', ${item.price})" style="background: #27ae60; color: white; border: none; border-radius: 4px; width: 24px; height: 24px; cursor: pointer; font-size: 12px;">+</button>
                        <div style="color: #27ae60; font-weight: bold; min-width: 60px; text-align: right; font-size: 13px;">$${(item.price * item.quantity).toLocaleString()}</div>
                    </div>
                </div>
            `).join('');

                totalElement.textContent = total.toLocaleString();
            }

            function removeFromCart(id) {
                const itemIndex = cart.findIndex(item => item.id === id);
                if (itemIndex > -1) {
                    cart[itemIndex].quantity -= 1;
                    if (cart[itemIndex].quantity === 0) {
                        cart.splice(itemIndex, 1);
                    }
                    updateCartDisplay();
                }
            }

            function clearCart() {
                cart = [];
                updateCartDisplay();
            }

            async function processSale() {
                if (cart.length === 0) {
                    alert('El carrito est√° vac√≠o');
                    return;
                }

                const paymentMethod = document.getElementById('payment-method').value;
                const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);

                try {
                    await apiCall('/pos/sale', 'POST', {
                        items: cart,
                        payment_method: paymentMethod,
                        total: total
                    });

                    alert(`‚úÖ Venta procesada exitosamente!\nüí∞ Total: $${total.toLocaleString()}\nüí≥ M√©todo: ${getPaymentMethodName(paymentMethod)}`);
                    cart = [];
                    updateCartDisplay();
                    loadProducts(); // Refresh to update stock
                } catch (error) {
                    console.error('Error processing sale:', error);
                    alert('Error al procesar la venta');
                }
            }

            function getPaymentMethodName(method) {
                const methods = {
                    'cash': 'Efectivo',
                    'card': 'Tarjeta',
                    'room': 'Cargar a Habitaci√≥n'
                };
                return methods[method] || method;
            }

            // Product management functions
            function showAddProductModal() {
                document.getElementById('product-modal-title').textContent = 'Nuevo Producto';
                document.getElementById('product-form').reset();
                document.getElementById('product-form').removeAttribute('data-product-id');
                document.getElementById('product-modal').style.display = 'flex';
            }

            function showEditProductModal(productId) {
                const product = products.find(p => p.id === productId);
                if (!product) return;

                document.getElementById('product-modal-title').textContent = 'Editar Producto';
                document.getElementById('product-form').setAttribute('data-product-id', productId);

                document.getElementById('product-name').value = product.name;
                document.getElementById('product-price').value = product.price;
                document.getElementById('product-stock').value = product.stock;
                document.getElementById('product-category').value = product.category;

                document.getElementById('product-modal').style.display = 'flex';
            }

            function closeProductModal() {
                document.getElementById('product-modal').style.display = 'none';
                document.getElementById('product-form').reset();
            }

            async function deleteProduct(productId) {
                if (confirm('¬øEst√°s seguro de que deseas eliminar este producto?')) {
                    try {
                        await apiCall(`/products/${productId}`, 'DELETE');
                        alert('Producto eliminado exitosamente');
                        loadProducts();
                    } catch (error) {
                        console.error('Error deleting product:', error);
                        alert('Error al eliminar el producto');
                    }
                }
            }

            // ============= GUESTS FUNCTIONALITY =============
            function showAddGuestModal() {
                document.getElementById('guest-modal-title').textContent = 'Nuevo Hu√©sped';
                document.getElementById('guest-form').reset();
                document.getElementById('guest-form').removeAttribute('data-guest-id');
                document.getElementById('guest-modal').style.display = 'flex';
            }

            function showEditGuestModal(guestId) {
                document.getElementById('guest-modal-title').textContent = 'Editar Hu√©sped';
                document.getElementById('guest-form').setAttribute('data-guest-id', guestId);
                loadGuestForEdit(guestId);
                document.getElementById('guest-modal').style.display = 'flex';
            }

            async function loadGuestForEdit(guestId) {
                try {
                    const guest = await apiCall(`/guests/${guestId}`);
                    if (guest) {
                        document.getElementById('guest-name').value = guest.name || '';
                        document.getElementById('guest-document').value = guest.document || '';
                        document.getElementById('guest-email').value = guest.email || '';
                        document.getElementById('guest-phone').value = guest.phone || '';
                    }
                } catch (error) {
                    console.error('Error loading guest:', error);
                    alert('Error al cargar los datos del hu√©sped');
                }
            }

            function closeGuestModal() {
                document.getElementById('guest-modal').style.display = 'none';
                document.getElementById('guest-form').reset();
            }

            function showGuestDetails(guestId) {
                loadGuestDetails(guestId);
                document.getElementById('guest-details-modal').style.display = 'flex';
            }

            async function loadGuestDetails(guestId) {
                try {
                    const guest = await apiCall(`/guests/${guestId}`);
                    if (guest) {
                        const content = document.getElementById('guest-details-content');
                        content.innerHTML = `
                        <div style="display: grid; gap: 20px;">
                            <!-- Informaci√≥n personal -->
                            <div style="background: rgba(255,255,255,0.95); box-shadow: 0 8px 32px rgba(0,0,0,0.1); padding: 20px; border-radius: 10px;">
                                <h3 style="color: #2c3e50; margin-bottom: 15px; display: flex; align-items: center;">
                                    <i class="fas fa-user" style="margin-right: 10px;"></i>
                                    Informaci√≥n Personal
                                </h3>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                    <div>
                                        <label style="color: #2c3e50; font-size: 12px; display: block;">Nombre Completo:</label>
                                        <div style="color: #2c3e50; font-weight: bold; font-size: 16px;">${guest.name}</div>
                                    </div>
                                    <div>
                                        <label style="color: #2c3e50; font-size: 12px; display: block;">Documento:</label>
                                        <div style="color: #2c3e50; font-weight: bold; font-size: 16px;">${guest.document}</div>
                                    </div>
                                    <div>
                                        <label style="color: #2c3e50; font-size: 12px; display: block;">Email:</label>
                                        <div style="color: #2c3e50; font-weight: bold; font-size: 16px;">${guest.email || 'No registrado'}</div>
                                    </div>
                                    <div>
                                        <label style="color: #2c3e50; font-size: 12px; display: block;">Tel√©fono:</label>
                                        <div style="color: #2c3e50; font-weight: bold; font-size: 16px;">${guest.phone || 'No registrado'}</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Estad√≠sticas -->
                            <div style="background: rgba(255,255,255,0.95); box-shadow: 0 8px 32px rgba(0,0,0,0.1); padding: 20px; border-radius: 10px;">
                                <h3 style="color: #2c3e50; margin-bottom: 15px; display: flex; align-items: center;">
                                    <i class="fas fa-chart-bar" style="margin-right: 10px;"></i>
                                    Estad√≠sticas de Hospedaje
                                </h3>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 15px;">
                                    <div style="text-align: center; padding: 15px; background: linear-gradient(135deg, #e8f4fd, #d4e6f1); border-radius: 8px;">
                                        <div style="color: #2c3e50; font-size: 24px; font-weight: bold;">0</div>
                                        <div style="color: #2c3e50; font-size: 12px;">Visitas</div>
                                    </div>
                                    <div style="text-align: center; padding: 15px; background: linear-gradient(135deg, #e8f5e8, #d4ecd4); border-radius: 8px;">
                                        <div style="color: #2c3e50; font-size: 24px; font-weight: bold;">0</div>
                                        <div style="color: #2c3e50; font-size: 12px;">Noches</div>
                                    </div>
                                    <div style="text-align: center; padding: 15px; background: linear-gradient(135deg, #fef3e2, #fce4b8); border-radius: 8px;">
                                        <div style="color: #2c3e50; font-size: 24px; font-weight: bold;">$0</div>
                                        <div style="color: #2c3e50; font-size: 12px;">Gastado</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Historial de reservas -->
                            <div style="background: rgba(255,255,255,0.95); box-shadow: 0 8px 32px rgba(0,0,0,0.1); padding: 20px; border-radius: 10px;">
                                <h3 style="color: #2c3e50; margin-bottom: 15px; display: flex; align-items: center;">
                                    <i class="fas fa-history" style="margin-right: 10px;"></i>
                                    Historial de Reservas
                                </h3>
                                <div style="color: #2c3e50; text-align: center; padding: 20px;">
                                    <i class="fas fa-calendar-alt" style="font-size: 48px; margin-bottom: 10px; opacity: 0.5;"></i>
                                    <p>No hay reservas registradas para este hu√©sped</p>
                                </div>
                            </div>

                            <!-- Acciones -->
                            <div style="display: flex; gap: 10px;">
                                <button onclick="showEditGuestModal(${guest.id}); closeGuestDetailsModal();" style="flex: 1; padding: 12px; background: linear-gradient(135deg, #3498db, #2980b9); color: #2c3e50; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                                    <i class="fas fa-edit"></i> Editar
                                </button>
                                <button onclick="confirmDeleteGuest(${guest.id})" style="flex: 1; padding: 12px; background: linear-gradient(135deg, #e74c3c, #c0392b); color: #2c3e50; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                                    <i class="fas fa-trash"></i> Eliminar
                                </button>
                            </div>
                        </div>
                    `;
                    }
                } catch (error) {
                    console.error('Error loading guest details:', error);
                    alert('Error al cargar los detalles del hu√©sped');
                }
            }

            function closeGuestDetailsModal() {
                document.getElementById('guest-details-modal').style.display = 'none';
            }

            async function deleteGuest(guestId) {
                try {
                    const result = await apiCall(`/guests/${guestId}`, 'DELETE');
                    if (result) {
                        alert('Hu√©sped eliminado exitosamente');
                        closeGuestDetailsModal();
                        await refreshGuests();
                    }
                } catch (error) {
                    console.error('Error deleting guest:', error);
                    alert('Error al eliminar el hu√©sped');
                }
            }

            function confirmDeleteGuest(guestId) {
                if (confirm('¬øEst√°s seguro de que deseas eliminar este hu√©sped? Esta acci√≥n no se puede deshacer.')) {
                    deleteGuest(guestId);
                }
            }

            // ============= GENERAL FUNCTIONALITY =============

            // ============= STAFF FUNCTIONALITY =============
            let staff = [];

            async function loadStaff() {
                try {
                    const response = await apiCall('/staff');
                    if (response) {
                        staff = response;
                        renderStaffList(response);
                    }
                } catch (error) {
                    console.error('Error loading staff:', error);
                }
            }

            function renderStaffList(staffList) {
                const container = document.getElementById('staff-list');

                if (!staffList || staffList.length === 0) {
                    container.innerHTML = `
                    <div style="background: rgba(255,255,255,0.95); box-shadow: 0 8px 32px rgba(0,0,0,0.1); border-radius: 10px; padding: 40px; text-align: center;">
                        <h3 style="color: #2c3e50; margin: 0 0 10px 0;">üë®‚Äçüíº No hay empleados registrados</h3>
                        <p style="color: #7f8c8d;">Agrega empleados para gestionar el personal</p>
                        <button onclick="showAddStaffModal()" style="margin-top: 15px; padding: 10px 20px; background: #27ae60; color: white; border: none; border-radius: 5px; cursor: pointer;">
                            <i class="fas fa-plus"></i> Agregar Empleado
                        </button>
                    </div>
                `;
                    return;
                }

                // Group staff by position
                const positions = {};
                staffList.forEach(member => {
                    if (!positions[member.position]) {
                        positions[member.position] = [];
                    }
                    positions[member.position].push(member);
                });

                let html = '';
                Object.keys(positions).forEach(position => {
                    html += `
                    <div style="margin-bottom: 30px;">
                        <h3 style="color: #2c3e50; margin-bottom: 15px; border-bottom: 2px solid rgba(255,255,255,0.3); padding-bottom: 5px;">
                            ${getPositionIcon(position)} ${position}s
                        </h3>
                        <div style="display: grid; gap: 15px;">
                `;

                    positions[position].forEach(member => {
                        html += `
                        <div style="
                            background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
                            border-radius: 12px;
                            padding: 20px;
                            border: 2px solid rgba(255,255,255,0.2);
                            transition: all 0.3s ease;
                        " onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 8px 25px rgba(0,0,0,0.3)'"
                           onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">

                            <div style="display: grid; grid-template-columns: 1fr auto; gap: 20px; align-items: center;">
                                <div>
                                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                        <h4 style="color: #2c3e50; margin: 0; font-size: 18px; font-weight: bold;">${member.name}</h4>
                                        <span style="background: linear-gradient(135deg, #e8f4fd, #d4e6f1); color: #3498db; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: bold;">${member.position}</span>
                                    </div>

                                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; margin-bottom: 15px;">
                                        ${member.phone ? `
                                            <p style="color: #2c3e50; margin: 5px 0; display: flex; align-items: center; gap: 8px;">
                                                <span style="font-size: 14px;">üì±</span>
                                                <strong>Tel√©fono:</strong> ${member.phone}
                                            </p>
                                        ` : ''}
                                        ${member.email ? `
                                            <p style="color: #2c3e50; margin: 5px 0; display: flex; align-items: center; gap: 8px;">
                                                <span style="font-size: 14px;">üìß</span>
                                                <strong>Email:</strong> ${member.email}
                                            </p>
                                        ` : ''}
                                        ${member.salary ? `
                                            <p style="color: #2c3e50; margin: 5px 0; display: flex; align-items: center; gap: 8px;">
                                                <span style="font-size: 14px;">üí∞</span>
                                                <strong>Salario:</strong> $${member.salary.toLocaleString()}
                                            </p>
                                        ` : ''}
                                        ${member.schedule ? `
                                            <p style="color: #2c3e50; margin: 5px 0; display: flex; align-items: center; gap: 8px;">
                                                <span style="font-size: 14px;">‚è∞</span>
                                                <strong>Horario:</strong> ${member.schedule}
                                            </p>
                                        ` : ''}
                                    </div>
                                </div>

                                <div style="display: flex; flex-direction: column; gap: 8px;">
                                    <button onclick="showEditStaffModal(${member.id})" style="padding: 8px 16px; background: linear-gradient(135deg, #3498db, #2980b9); color: #2c3e50; border: none; border-radius: 8px; cursor: pointer; font-size: 12px; font-weight: bold;">
                                        ‚úèÔ∏è Editar
                                    </button>
                                    <button onclick="deleteStaff(${member.id})" style="padding: 8px 16px; background: linear-gradient(135deg, #e74c3c, #c0392b); color: #2c3e50; border: none; border-radius: 8px; cursor: pointer; font-size: 12px; font-weight: bold;">
                                        üóëÔ∏è Eliminar
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                    });

                    html += `
                        </div>
                    </div>
                `;
                });

                container.innerHTML = html;
            }

            function getPositionIcon(position) {
                const icons = {
                    'Recepcionista': 'üè®',
                    'Limpieza': 'üßπ',
                    'Seguridad': 'üõ°Ô∏è',
                    'Mantenimiento': 'üîß',
                    'Gerente': 'üëî',
                    'Contador': 'üìä'
                };
                return icons[position] || 'üë§';
            }

            function showAddStaffModal() {
                document.getElementById('staff-modal-title').textContent = 'Nuevo Empleado';
                document.getElementById('staff-form').reset();
                document.getElementById('staff-form').removeAttribute('data-staff-id');
                document.getElementById('staff-modal').style.display = 'flex';
            }

            function showEditStaffModal(staffId) {
                const member = staff.find(s => s.id === staffId);
                if (!member) return;

                document.getElementById('staff-modal-title').textContent = 'Editar Empleado';
                document.getElementById('staff-form').setAttribute('data-staff-id', staffId);

                document.getElementById('staff-name').value = member.name;
                document.getElementById('staff-position').value = member.position;
                document.getElementById('staff-phone').value = member.phone || '';
                document.getElementById('staff-email').value = member.email || '';
                document.getElementById('staff-salary').value = member.salary || '';
                document.getElementById('staff-schedule').value = member.schedule || '';

                document.getElementById('staff-modal').style.display = 'flex';
            }

            function closeStaffModal() {
                document.getElementById('staff-modal').style.display = 'none';
                document.getElementById('staff-form').reset();
            }

            async function deleteStaff(staffId) {
                if (confirm('¬øEst√°s seguro de que deseas eliminar este empleado?')) {
                    try {
                        await apiCall(`/staff/${staffId}`, 'DELETE');
                        alert('Empleado eliminado exitosamente');
                        loadStaff();
                    } catch (error) {
                        console.error('Error deleting staff:', error);
                        alert('Error al eliminar el empleado');
                    }
                }
            }

            // ============= TOURS FUNCTIONALITY =============
            let tours = [];
            let tourStats = {};

            async function loadTours() {
                try {
                    const [toursResponse, statsResponse] = await Promise.all([
                        apiCall('/tours'),
                        apiCall('/tours/stats')
                    ]);

                    if (toursResponse) {
                        tours = toursResponse;
                        renderToursCatalog(toursResponse);
                    }

                    if (statsResponse) {
                        tourStats = statsResponse;
                        updateToursStats(statsResponse);
                    }
                } catch (error) {
                    console.error('Error loading tours:', error);
                }
            }

            function updateToursStats(stats) {
                document.getElementById('total-tours-count').textContent = stats.total_tours || 0;
                document.getElementById('total-clicks-count').textContent = stats.total_clicks || 0;
                document.getElementById('total-commissions').textContent = `$${stats.total_commissions?.toLocaleString() || 0}`;

                const conversionRate = stats.total_clicks > 0 ? ((stats.total_commissions / stats.total_clicks) * 100).toFixed(1) : 0;
                document.getElementById('conversion-rate').textContent = `${conversionRate}%`;
            }

            function renderToursCatalog(toursList) {
                const container = document.getElementById('all-tours');

                if (!toursList || toursList.length === 0) {
                    container.innerHTML = `
                    <div style="grid-column: 1/-1; background: rgba(255,255,255,0.95); box-shadow: 0 8px 32px rgba(0,0,0,0.1); border-radius: 10px; padding: 40px; text-align: center;">
                        <h3 style="color: #2c3e50; margin: 0 0 10px 0;">üó∫Ô∏è No hay tours disponibles</h3>
                        <p style="color: #7f8c8d;">Agrega tours para ofrecer a tus hu√©spedes</p>
                        <button onclick="showAddTourModal()" style="margin-top: 15px; padding: 10px 20px; background: #27ae60; color: white; border: none; border-radius: 5px; cursor: pointer;">
                            <i class="fas fa-plus"></i> Agregar Tour
                        </button>
                    </div>
                `;
                    return;
                }

                container.innerHTML = toursList.map(tour => {
                    const images = JSON.parse(tour.images || '[]');
                    return `
                    <div style="
                        background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
                        border-radius: 15px;
                        overflow: hidden;
                        border: 2px solid rgba(255,255,255,0.2);
                        transition: all 0.3s ease;
                        position: relative;
                    " onmouseover="this.style.transform='translateY(-8px)'; this.style.boxShadow='0 12px 35px rgba(0,0,0,0.4)'"
                       onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">

                        <!-- Tour image placeholder -->
                        <div style="height: 180px; background: linear-gradient(135deg, #667eea, #764ba2); position: relative; display: flex; align-items: center; justify-content: center;">
                            <div style="color: #2c3e50; font-size: 48px;">üèûÔ∏è</div>
                            <div style="position: absolute; top: 10px; right: 10px; background: rgba(0,0,0,0.7); color: #2c3e50; padding: 5px 10px; border-radius: 15px; font-size: 12px; font-weight: bold;">
                                ${tour.duration}
                            </div>
                            <div style="position: absolute; bottom: 10px; left: 10px; background: rgba(39, 174, 96, 0.9); color: #2c3e50; padding: 5px 10px; border-radius: 15px; font-size: 12px; font-weight: bold;">
                                ${tour.commission_rate}% comisi√≥n
                            </div>
                        </div>

                        <div style="padding: 20px;">
                            <h3 style="color: #2c3e50; margin: 0 0 10px 0; font-size: 18px; font-weight: bold;">${tour.name}</h3>
                            <p style="color: #2c3e50; font-size: 14px; margin: 10px 0; line-height: 1.4; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden;">
                                ${tour.description}
                            </p>

                            <div style="display: flex; justify-content: space-between; align-items: center; margin: 15px 0;">
                                <div>
                                    <div style="color: #27ae60; font-size: 20px; font-weight: bold;">$${tour.price.toLocaleString()}</div>
                                    <div style="color: #95a5a6; font-size: 12px;">Por persona</div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="color: #2c3e50; font-size: 14px; font-weight: 600; font-weight: bold;">${tour.clicks || 0} clicks</div>
                                    <div style="color: #95a5a6; font-size: 12px;">Proveedor: ${tour.provider}</div>
                                </div>
                            </div>

                            <div style="display: flex; gap: 8px; margin-top: 15px;">
                                <button onclick="trackTourClick(${tour.id})" style="flex: 1; padding: 10px; background: linear-gradient(135deg, #3498db, #2980b9); color: #2c3e50; border: none; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: bold;">
                                    üîó Reservar Tour
                                </button>
                                <button onclick="showEditTourModal(${tour.id})" style="padding: 10px 12px; background: linear-gradient(135deg, #f39c12, #e67e22); color: #2c3e50; border: none; border-radius: 8px; cursor: pointer; font-size: 12px;">
                                    ‚úèÔ∏è
                                </button>
                                <button onclick="deleteTour(${tour.id})" style="padding: 10px 12px; background: linear-gradient(135deg, #e74c3c, #c0392b); color: #2c3e50; border: none; border-radius: 8px; cursor: pointer; font-size: 12px;">
                                    üóëÔ∏è
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                }).join('');
            }

            async function trackTourClick(tourId) {
                try {
                    const tour = tours.find(t => t.id === tourId);
                    if (!tour) return;

                    // Track the click
                    await apiCall(`/tours/${tourId}/click`, 'POST', {
                        guest_id: null // Could be enhanced to track which guest clicked
                    });

                    // Open the booking URL in a new window
                    if (tour.booking_url) {
                        window.open(tour.booking_url, '_blank');

                        // Show info about the commission
                        alert(`‚úÖ Click registrado!\nüéØ Tour: ${tour.name}\nüí∞ Comisi√≥n: ${tour.commission_rate}%\n\nEl hu√©sped ser√° redirigido al proveedor para completar la reserva.`);

                        // Refresh stats
                        loadTours();
                    } else {
                        alert('URL de reserva no configurada para este tour');
                    }
                } catch (error) {
                    console.error('Error tracking tour click:', error);
                    alert('Error al registrar el click');
                }
            }

            function showAddTourModal() {
                document.getElementById('tour-modal-title').textContent = 'Nuevo Tour';
                document.getElementById('tour-form').reset();
                document.getElementById('tour-form').removeAttribute('data-tour-id');
                document.getElementById('tour-modal').style.display = 'flex';
            }

            function showEditTourModal(tourId) {
                const tour = tours.find(t => t.id === tourId);
                if (!tour) return;

                document.getElementById('tour-modal-title').textContent = 'Editar Tour';
                document.getElementById('tour-form').setAttribute('data-tour-id', tourId);

                document.getElementById('tour-name').value = tour.name;
                document.getElementById('tour-description').value = tour.description;
                document.getElementById('tour-price').value = tour.price;
                document.getElementById('tour-duration').value = tour.duration;
                document.getElementById('tour-provider').value = tour.provider;
                document.getElementById('tour-commission').value = tour.commission_rate;
                document.getElementById('tour-url').value = tour.booking_url;

                document.getElementById('tour-modal').style.display = 'flex';
            }

            function closeTourModal() {
                document.getElementById('tour-modal').style.display = 'none';
                document.getElementById('tour-form').reset();
            }

            async function deleteTour(tourId) {
                if (confirm('¬øEst√°s seguro de que deseas eliminar este tour?')) {
                    try {
                        await apiCall(`/tours/${tourId}`, 'DELETE');
                        alert('Tour eliminado exitosamente');
                        loadTours();
                    } catch (error) {
                        console.error('Error deleting tour:', error);
                        alert('Error al eliminar el tour');
                    }
                }
            }

            function showCashMovementModal() {
                alert('Funci√≥n de movimiento de caja - En desarrollo');
            }

            function selectGuestForCheckin(guestId) {
                // Redirigir a la vista de camas con el hu√©sped seleccionado para check-in
                localStorage.setItem('selectedGuestForCheckin', guestId);
                showView('beds');
                alert('Ve a la vista de camas y selecciona una cama disponible para hacer el check-in de este hu√©sped');
            }

            async function startCheckin(bedId, preselectedGuestId = null) {
                try {
                    if (preselectedGuestId) {
                        // Hacer check-in directo con hu√©sped preseleccionado
                        await processCheckin(bedId, preselectedGuestId);
                    } else {
                        // Mostrar modal para seleccionar hu√©sped
                        await showGuestSelectionForCheckin(bedId);
                    }
                } catch (error) {
                    console.error('Error starting checkin:', error);
                    alert('Error al iniciar el check-in');
                }
            }

            async function showGuestSelectionForCheckin(bedId) {
                try {
                    const guests = await apiCall('/guests');
                    // Filtrar solo hu√©spedes que no est√©n actualmente hospedados
                    const availableGuests = guests.filter(guest => !guest.current_bed_name);

                    if (availableGuests.length === 0) {
                        alert('No hay hu√©spedes disponibles para check-in. Primero registra un hu√©sped.');
                        return;
                    }

                    const guestOptions = availableGuests.map(guest =>
                        `${guest.name} (${guest.document})`
                    ).join('\n');

                    const selectedIndex = prompt(`Selecciona un hu√©sped para el check-in en la cama ${bedId}:\n\n${availableGuests.map((guest, index) =>
                        `${index + 1}. ${guest.name} (${guest.document})`
                    ).join('\n')}\n\nIngresa el n√∫mero del hu√©sped:`);

                    if (selectedIndex && selectedIndex > 0 && selectedIndex <= availableGuests.length) {
                        const selectedGuest = availableGuests[selectedIndex - 1];
                        await processCheckin(bedId, selectedGuest.id);
                    }
                } catch (error) {
                    console.error('Error showing guest selection:', error);
                    alert('Error al cargar los hu√©spedes disponibles');
                }
            }

            async function processCheckin(bedId, guestId) {
                try {
                    const result = await apiCall(`/beds/${bedId}/checkin`, 'POST', { guestId });
                    if (result) {
                        alert('Check-in realizado exitosamente');
                        localStorage.removeItem('selectedGuestForCheckin');
                        await refreshBeds();
                        await refreshGuests();
                    }
                } catch (error) {
                    console.error('Error processing checkin:', error);
                    alert('Error al procesar el check-in: ' + (error.message || 'Error desconocido'));
                }
            }

            async function startCheckout(bedId) {
                if (confirm('¬øEst√°s seguro de que deseas hacer check-out de esta cama?')) {
                    try {
                        const result = await apiCall(`/beds/${bedId}/checkout`, 'POST');
                        if (result) {
                            alert('Check-out realizado exitosamente');
                            await refreshBeds();
                            await refreshGuests();
                        }
                    } catch (error) {
                        console.error('Error processing checkout:', error);
                        alert('Error al procesar el check-out: ' + (error.message || 'Error desconocido'));
                    }
                }
            }

            // Verificar si hay un hu√©sped preseleccionado para check-in cuando se carga la vista de camas
            function checkPreselectedGuest() {
                const selectedGuestId = localStorage.getItem('selectedGuestForCheckin');
                if (selectedGuestId) {
                    alert('Hu√©sped seleccionado para check-in. Ahora selecciona una cama disponible.');
                    // Resaltar camas disponibles
                    const availableBeds = document.querySelectorAll('[data-bed-status="clean"]');
                    availableBeds.forEach(bed => {
                        bed.style.animation = 'pulse 2s infinite';
                    });
                }
            }

            // ============= ANALYTICS & REPORTS FUNCTIONALITY =============
            let currentReportData = null;

            async function refreshReports() {
                console.log('üìà Cargando sistema de reportes y an√°lisis...');
                initializeReportDates();
                await generateAnalyticsReport();
            }

            function initializeReportDates() {
                const today = new Date();
                const thirtyDaysAgo = new Date();
                thirtyDaysAgo.setDate(today.getDate() - 30);

                document.getElementById('reportEndDate').value = today.toISOString().split('T')[0];
                document.getElementById('reportStartDate').value = thirtyDaysAgo.toISOString().split('T')[0];
            }

            function selectReportPeriod(btn, days) {
                // Remove active class from all buttons
                document.querySelectorAll('.date-btn').forEach(b => b.classList.remove('report-active'));

                // Add active class to clicked button
                btn.classList.add('report-active');

                // Calculate dates
                const endDate = new Date();
                const startDate = new Date();
                startDate.setDate(endDate.getDate() - days);

                // Update date inputs
                document.getElementById('reportEndDate').value = endDate.toISOString().split('T')[0];
                document.getElementById('reportStartDate').value = startDate.toISOString().split('T')[0];

                // Auto-generate report
                generateAnalyticsReport();
            }

            async function generateAnalyticsReport() {
                const startDate = document.getElementById('reportStartDate').value;
                const endDate = document.getElementById('reportEndDate').value;
                const reportType = document.getElementById('reportType').value;

                if (!startDate || !endDate) {
                    alert('Por favor selecciona fechas de inicio y fin');
                    return;
                }

                try {
                    console.log(`üìä Generando reporte ${reportType} del ${startDate} al ${endDate}`);

                    // Add loading effect
                    const reportContent = document.getElementById('reportContent');
                    reportContent.style.opacity = '0.5';

                    // Fetch comprehensive analytics data
                    const reportData = await apiCall(`/reports?start=${startDate}&end=${endDate}&type=${reportType}`);

                    if (reportData) {
                        currentReportData = reportData;
                        updateReportPeriodBadge(startDate, endDate);
                        updateKPIs(reportData);
                        updateCharts(reportData);
                        updateTopPerformers(reportData);
                        updateAdditionalAnalytics(reportData);
                    }

                    reportContent.style.opacity = '1';

                    // Add animation to KPI cards
                    document.querySelectorAll('[id^="kpi"]').forEach((card, index) => {
                        setTimeout(() => {
                            card.style.transform = 'scale(1.02)';
                            setTimeout(() => {
                                card.style.transform = 'scale(1)';
                            }, 200);
                        }, index * 100);
                    });

                    console.log('üìä Reporte generado exitosamente');

                } catch (error) {
                    console.error('Error generando reporte:', error);
                    alert('Error al generar el reporte. Por favor intenta nuevamente.');
                    document.getElementById('reportContent').style.opacity = '1';
                }
            }

            function updateReportPeriodBadge(startDate, endDate) {
                const start = new Date(startDate).toLocaleDateString('es-ES');
                const end = new Date(endDate).toLocaleDateString('es-ES');
                const days = Math.ceil((new Date(endDate) - new Date(startDate)) / (1000 * 60 * 60 * 24));

                document.getElementById('reportPeriodBadge').textContent = `${start} al ${end} (${days} d√≠as)`;
            }

            function updateKPIs(data) {
                // Update Revenue KPI
                const totalRevenue = (data.totalRevenue?.bookingRevenue || 0) + (data.totalRevenue?.posRevenue || 0);
                const dailyAvg = data.totalBookings?.count > 0 ? totalRevenue / data.totalBookings.count : 0;

                const revenueCard = document.getElementById('kpiRevenue');
                revenueCard.querySelector('div:first-child').textContent = `$${totalRevenue.toLocaleString()}`;
                revenueCard.querySelector('div:last-child').textContent = `Promedio diario: $${dailyAvg.toFixed(0)}`;

                // Update Occupancy KPI
                const occupancyRate = data.occupancyData?.avgOccupancy || 0;
                const totalNights = data.totalBookings?.totalNights || 0;

                const occupancyCard = document.getElementById('kpiOccupancy');
                occupancyCard.querySelector('div:first-child').textContent = `${occupancyRate.toFixed(1)}%`;
                occupancyCard.querySelector('div:last-child').textContent = `${totalNights} noches vendidas`;

                // Update Guests KPI
                const totalGuests = data.totalGuests?.uniqueGuests || 0;
                const returningGuests = data.totalGuests?.returningGuests || 0;

                const guestsCard = document.getElementById('kpiGuests');
                guestsCard.querySelector('div:first-child').textContent = totalGuests;
                guestsCard.querySelector('div:last-child').textContent = `${returningGuests} hu√©spedes recurrentes`;

                // Update Average Rate KPI
                const avgRate = data.totalBookings?.avgRate || 0;

                const rateCard = document.getElementById('kpiRate');
                rateCard.querySelector('div:first-child').textContent = `$${avgRate.toFixed(0)}`;
            }

            function updateCharts(data) {
                // Update Revenue Chart
                const revenueChart = document.getElementById('revenueChart');
                const weeklyRevenue = data.weeklyRevenue || [];

                revenueChart.innerHTML = '';
                weeklyRevenue.forEach((week, index) => {
                    const height = Math.max(20, (week.revenue / Math.max(...weeklyRevenue.map(w => w.revenue))) * 180);
                    const bar = document.createElement('div');
                    bar.className = 'chart-bar revenue-bar';
                    bar.style.width = '50px';
                    bar.style.height = `${height}px`;
                    bar.textContent = `$${(week.revenue / 1000).toFixed(1)}K`;
                    bar.title = `Semana ${index + 1}: $${week.revenue.toLocaleString()}`;
                    revenueChart.appendChild(bar);
                });

                // Update Occupancy Chart
                const occupancyChart = document.getElementById('occupancyChart');
                const dailyOccupancy = data.dailyOccupancy || [];

                occupancyChart.innerHTML = '';
                dailyOccupancy.slice(-7).forEach((day) => {
                    const height = Math.max(20, (day.occupancy / 100) * 180);
                    const bar = document.createElement('div');
                    bar.className = 'chart-bar occupancy-bar';

                    if (day.occupancy >= 80) {
                        bar.classList.add('occupancy-high');
                    } else if (day.occupancy >= 60) {
                        bar.classList.add('occupancy-medium');
                    } else {
                        bar.classList.add('occupancy-low');
                    }

                    bar.style.height = `${height}px`;
                    bar.title = `${day.date}: ${day.occupancy.toFixed(1)}%`;
                    occupancyChart.appendChild(bar);
                });
            }

            function updateTopPerformers(data) {
                // Top Guests
                const topGuests = data.topGuests || [];
                const topGuestsContainer = document.getElementById('topGuests');

                topGuestsContainer.innerHTML = topGuests.map(guest => `
                <div class="top-list-item">
                    <span class="item-name">${guest.name}</span>
                    <span class="item-value value-nights">${guest.nights} noches</span>
                </div>
            `).join('');

                // Top Products
                const topProducts = data.topProducts || [];
                const topProductsContainer = document.getElementById('topProducts');

                topProductsContainer.innerHTML = topProducts.map(product => `
                <div class="top-list-item">
                    <span class="item-name">${product.name}</span>
                    <span class="item-value value-sales">${product.quantity} vendidos</span>
                </div>
            `).join('');
            }

            function updateAdditionalAnalytics(data) {
                // Weekend Occupancy
                const weekendOccupancy = data.additionalMetrics?.weekendOccupancy || 0;
                const weekendCard = document.getElementById('weekendOccupancy');
                weekendCard.querySelector('div:first-child').textContent = `${weekendOccupancy.toFixed(1)}%`;

                // Average Stay
                const avgStay = data.additionalMetrics?.avgStayDuration || 0;
                const stayCard = document.getElementById('avgStay');
                stayCard.querySelector('div:first-child').textContent = `${avgStay.toFixed(1)} d√≠as`;

                // Returning Guests Rate
                const returningRate = data.additionalMetrics?.returningGuestRate || 0;
                const returningCard = document.getElementById('returningGuests');
                returningCard.querySelector('div:first-child').textContent = `${returningRate.toFixed(1)}%`;

                // POS Revenue
                const posRevenue = data.totalRevenue?.posRevenue || 0;
                const totalRevenue = (data.totalRevenue?.bookingRevenue || 0) + posRevenue;
                const posPercentage = totalRevenue > 0 ? (posRevenue / totalRevenue) * 100 : 0;

                const posCard = document.getElementById('posRevenue');
                posCard.querySelector('div:first-child').textContent = `$${posRevenue.toLocaleString()}`;
                posCard.querySelector('div:last-child').textContent = `${posPercentage.toFixed(1)}% del total`;
            }

            async function exportAnalyticsReport() {
                if (!currentReportData) {
                    alert('Primero genera un reporte para poder exportar');
                    return;
                }

                try {
                    const startDate = document.getElementById('reportStartDate').value;
                    const endDate = document.getElementById('reportEndDate').value;
                    const reportType = document.getElementById('reportType').value;

                    const exportData = {
                        period: {
                            start: startDate,
                            end: endDate,
                            type: reportType
                        },
                        data: currentReportData,
                        generated: new Date().toISOString(),
                        generatedBy: 'Hostel PMS'
                    };

                    const dataStr = JSON.stringify(exportData, null, 2);
                    const dataBlob = new Blob([dataStr], { type: 'application/json' });
                    const url = URL.createObjectURL(dataBlob);
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = `almanik-report-${startDate}-to-${endDate}.json`;
                    link.click();

                    console.log('üì• Reporte exportado exitosamente');
                    alert('‚úÖ Reporte exportado exitosamente');

                } catch (error) {
                    console.error('Error exportando reporte:', error);
                    alert('Error al exportar el reporte');
                }
            }

            // ============= PASEOS FUNCTIONALITY =============
            function loadTours() {
                const todayTours = [
                    { id: 1, name: 'City Walking Tour', time: '09:00', duration: '3h', price: 25, participants: 6, guide: 'Carlos' },
                    { id: 2, name: 'Mercado Central', time: '14:00', duration: '2h', price: 15, participants: 4, guide: 'Ana' },
                    { id: 3, name: 'Sunset Viewpoint', time: '17:30', duration: '2h', price: 20, participants: 8, guide: 'Luis' }
                ];

                const allTours = [
                    { id: 1, name: 'City Walking Tour', duration: '3h', price: 25, description: 'Tour por el centro hist√≥rico' },
                    { id: 2, name: 'Mercado Central', duration: '2h', price: 15, description: 'Visita al mercado local' },
                    { id: 3, name: 'Sunset Viewpoint', duration: '2h', price: 20, description: 'Mirador para ver el atardecer' },
                    { id: 4, name: 'Beach Day', duration: '6h', price: 35, description: 'D√≠a completo en la playa' },
                    { id: 5, name: 'Mountain Hike', duration: '4h', price: 30, description: 'Caminata en monta√±a' }
                ];

                renderTodayTours(todayTours);
                renderAllTours(allTours);
                renderTourBookings();
            }

            function renderTodayTours(tours) {
                const container = document.getElementById('today-tours');
                if (!container) {
                    console.warn('today-tours container not found - skipping render');
                    return;
                }
                container.innerHTML = tours.map(tour => `
                <div style="background: rgba(255,255,255,0.95); box-shadow: 0 8px 32px rgba(0,0,0,0.1); border-radius: 10px; padding: 15px; border-left: 4px solid #3498db;">
                    <h3 style="color: #2c3e50; margin: 0 0 10px 0;">üö∂ ${tour.name}</h3>
                    <p style="color: #2c3e50; margin: 5px 0;">‚è∞ ${tour.time} (${tour.duration})</p>
                    <p style="color: #2c3e50; margin: 5px 0;">üë• ${tour.participants} participantes</p>
                    <p style="color: #2c3e50; margin: 5px 0;">üßë‚Äçüè´ Gu√≠a: ${tour.guide}</p>
                    <p style="color: #2c3e50; margin: 10px 0;">üí∞ $${tour.price}/persona</p>
                    <button onclick="manageTour(${tour.id})" style="width: 100%; padding: 8px; background: #27ae60; color: white; border: none; border-radius: 5px; cursor: pointer;">
                        Gestionar
                    </button>
                </div>
            `).join('');
            }

            function renderAllTours(tours) {
                const container = document.getElementById('all-tours');
                container.innerHTML = tours.map(tour => `
                <div style="background: rgba(255,255,255,0.95); box-shadow: 0 8px 32px rgba(0,0,0,0.1); border-radius: 10px; padding: 15px;">
                    <h3 style="color: #2c3e50; margin: 0 0 10px 0;">üó∫Ô∏è ${tour.name}</h3>
                    <p style="color: #2c3e50; margin: 5px 0;">${tour.description}</p>
                    <p style="color: #2c3e50; margin: 5px 0;">‚è±Ô∏è Duraci√≥n: ${tour.duration}</p>
                    <p style="color: #2c3e50; margin: 10px 0; font-weight: bold;">üí∞ $${tour.price}/persona</p>
                    <div style="display: flex; gap: 10px;">
                        <button onclick="bookTour(${tour.id})" style="flex: 1; padding: 8px; background: #9b59b6; color: #2c3e50; border: none; border-radius: 5px; cursor: pointer;">
                            Reservar
                        </button>
                        <button onclick="editTour(${tour.id})" style="flex: 1; padding: 8px; background: #f39c12; color: white; border: none; border-radius: 5px; cursor: pointer;">
                            Editar
                        </button>
                    </div>
                </div>
            `).join('');
            }

            function renderTourBookings() {
                const container = document.getElementById('tour-bookings');
                const bookings = [
                    { guest: 'Mar√≠a L√≥pez', tour: 'City Walking Tour', date: 'Hoy 09:00', status: 'confirmado', amount: 50 },
                    { guest: 'John Smith', tour: 'Beach Day', date: 'Ma√±ana 08:00', status: 'pendiente', amount: 70 },
                    { guest: 'Ana Garc√≠a', tour: 'Mountain Hike', date: 'Ma√±ana 14:00', status: 'confirmado', amount: 60 }
                ];

                container.innerHTML = `
                <div style="display: grid; gap: 10px;">
                    ${bookings.map(booking => `
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 15px; background: rgba(255,255,255,0.95); box-shadow: 0 8px 32px rgba(0,0,0,0.1); border-radius: 8px;">
                            <div>
                                <h4 style="color: #2c3e50; margin: 0 0 5px 0;">${booking.guest}</h4>
                                <p style="color: #2c3e50; margin: 2px 0;">${booking.tour}</p>
                                <p style="color: #95a5a6; margin: 2px 0;">${booking.date}</p>
                            </div>
                            <div style="text-align: right;">
                                <div style="color: ${booking.status === 'confirmado' ? '#27ae60' : '#f39c12'}; font-weight: bold; margin-bottom: 5px;">
                                    ${booking.status.toUpperCase()}
                                </div>
                                <div style="color: #2c3e50; font-weight: bold;">$${booking.amount}</div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
            }

            function showAddTourModal() {
                alert('Crear nuevo paseo - Funci√≥n en desarrollo');
            }

            function manageTour(tourId) {
                alert(`Gestionar paseo ${tourId} - Funci√≥n en desarrollo`);
            }

            function bookTour(tourId) {
                alert(`Reservar paseo ${tourId} - Funci√≥n en desarrollo`);
            }

            function editTour(tourId) {
                alert(`Editar paseo ${tourId} - Funci√≥n en desarrollo`);
            }

            // Load data when switching views
            const originalShowView = showView;
            showView = function (viewName) {
                originalShowView.call(this, viewName);

                // Load specific data based on view
                switch (viewName) {
                    case 'beds':
                        refreshBeds();
                        break;
                    case 'guests':
                        refreshGuests();
                        break;
                    case 'pos':
                        loadProducts();
                        break;
                    case 'reports':
                        refreshReports();
                        break;
                    case 'tours':
                        loadTours();
                        break;
                }
            };

            // Auto-refresh data every 30 seconds
            setInterval(() => {
                if (sessionId && !document.getElementById('dashboard-view').classList.contains('hidden')) {
                    loadDashboardData();
                }
            }, 30000);

            // Register Service Worker for PWA functionality
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', () => {
                    navigator.serviceWorker.register('/sw.js')
                        .then(registration => {
                            console.log('‚úÖ Service Worker registered successfully:', registration.scope);
                        })
                        .catch(error => {
                            console.error('‚ùå Service Worker registration failed:', error);
                        });
                });
            }
        </script>
</body>

</html>